/**
 * Module dependencies
 */
const { v4: uuidV4 } = require('uuid');

/**
 * Expose http request-id middleware
 */
module.exports = function forwardTraceRequestId(req, res, next) {
  let traceRequestId = req.get('x-request-id');

  if (traceRequestId === undefined || (traceRequestId && traceRequestId.length === 0)) {
    traceRequestId = uuidV4();
  }

  req.traceRequestId = traceRequestId;
  next();
};
