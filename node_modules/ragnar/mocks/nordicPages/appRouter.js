const React = require('react');
// eslint-disable-next-line import/no-extraneous-dependencies
const ReactDOMServer = require('react-dom/server');

const { router } = require('../..');

const appRouter = router();

appRouter.use((req, res, next) => {
  res.render = async (Page, props) => {
    const PageWithProps = React.createElement(Page, props);
    const markup = ReactDOMServer.renderToStaticMarkup(PageWithProps);
    res.send(markup);
  };
  next();
});

module.exports = appRouter;
