const headerProps = require('./props');

const baseProps = {
  platform: {
    siteId: 'MLA',
    id: 'ML',
    domain: 'www.mercadolibre.com',
  },
  device: {
    type: 'desktop',
    mobile: false,
    tablet: false,
    desktop: true,
    forced: false,
    originalType: 'desktop',
  },
  feConfigEnvironment: 'test',
  protocol: 'https',
  headers: {
    host: 'dev.mercadolibre.com:8443',
  },
  urls: {
    baseDomain: { link: 'https://www.mercadolibre.com.ar' },
  },
  labels: {
    headTitle: 'Mercado Libre',
    companyName: 'Mercado Libre',
    copyrightSince: '1999',
    mobileAppsStore: {
      ios: 'https://itunes.apple.com/es/app/id463624852',
      android: 'https://play.google.com/store/apps/details?id=com.mercadolibre',
    },
  },
  user: {
    id: 447469951,
    nickname: 'TETE8074471',
    active: true,
    scopes: ['read', 'write'],
    operator: false,
    operatorId: null,
    rootId: 447469951,
    admin: false,
    owner: true,
    raw: {
      id: 447469951,
      nickname: 'TETE8074471',
      registration_date: '2019-06-27T10:37:33.000-04:00',
      gender: '',
      country_id: 'AR',
      identification: {},
      internal_tags: [''],
      address: {},
      phone: {},
      alternative_phone: {},
      user_type: 'normal',
      tags: ['value'],
      logo: null,
      points: 100,
      site_id: 'MLA',
      permalink: 'http://perfil.mercadolibre.com.ar/TETE8074471',
      shipping_modes: ['value'],
      seller_experience: 'ADVANCED',
      bill_data: {},
      seller_reputation: {},
      buyer_reputation: {},
      status: {},
      secure_email: 'ttest.83jfqv@mail.mercadolibre.com',
      company: {},
      credit: {},
      context: {},
    },
  },
  melilab: {
    labUrl: 'https://www.mercadolibre.com/gz/labs',
    isEnabled: false,
    melilab: null,
    isMobile: false,
  },
  isLoggedIn: true,
};

jest.mock('first-party-navigation-config', () => ({
  getValue: jest.fn().mockImplementation(({ key }) => {
    const hash = {
      firstParty: {
        desktopHeaderLinks: [
          'some-header-link-1',
          'some-external-1',
          'some-header-link-2',
        ],
        desktopLoggedInHeaderMenuLinks: [
          'some-logged-link-1',
          'some-external-2',
          'some-logged-link-2',
        ],
        desktopLoggedOutHeaderMenuLinks: [
          'some-logged-out-link-1',
          'some-external-3',
          'some-logged-out-link-2',
        ],
        logoAsideText: 'Proveedores',
      },
      url: {
        'some-header-link-1': {
          link: 'some-header-link-1-link',
          name: 'some-header-link-1-name',
        },
        'some-header-link-2': {
          link: 'some-header-link-2-link',
          name: 'some-header-link-2-name',
        },
        'some-logged-link-1': {
          link: 'some-logged-link-1-link',
          name: 'some-logged-link-1-name',
        },
        'some-logged-link-2': {
          link: 'some-logged-link-2-link',
          name: 'some-logged-link-2-name',
        },
        'some-logged-out-link-1': {
          link: 'some-logged-out-link-1-link',
          name: 'some-logged-out-link-1-name',
        },
        'some-logged-out-link-2': {
          link: 'some-logged-out-link-2-link',
          name: 'some-logged-out-link-2-name',
        },
        firstPartyHome: {
          link: 'https://centrodeproveedores.mercadolibre.com',
        },
      },
    };

    return hash[key];
  }),
}));

jest.mock('frontend-config', () => ({
  get: jest.fn().mockImplementation((key) => {
    const hash = {
      url: {
        'some-external-1': {
          link: 'some-external-1-link',
          name: 'some-external-1-name',
        },
        'some-external-2': {
          link: 'some-external-2-link',
          name: 'some-external-2-name',
        },
        'some-external-3': {
          link: 'some-external-3-link',
          name: 'some-external-3-name',
        },
        myAccount: {
          name: 'Mi cuenta',
        },
      },
      companyName: 'MercadoLibre S.R.L.',
    };

    return hash[key];
  }),
}));

describe('FP Header Props', () => {
  it('returns correct header props for FP', () => {
    const result = headerProps(baseProps);
    expect(result).toEqual({
      headerLinks: [
        {
          id: 'some-header-link-1',
          link: 'some-header-link-1-link',
          name: 'some-header-link-1-name',
        },
        {
          id: 'some-external-1',
          link: 'some-external-1-link',
          name: 'some-external-1-name',
        },
        {
          id: 'some-header-link-2',
          link: 'some-header-link-2-link',
          name: 'some-header-link-2-name',
        },
      ],
      isDesktop: true,
      isLoggedIn: true,
      loggedInLinks: [
        {
          id: 'some-logged-link-1',
          link: 'some-logged-link-1-link',
          name: 'some-logged-link-1-name',
        },
        {
          id: 'some-external-2',
          link: 'some-external-2-link',
          name: 'some-external-2-name',
        },
        {
          id: 'some-logged-link-2',
          link: 'some-logged-link-2-link',
          name: 'some-logged-link-2-name',
        },
      ],
      loggedOutLinks: [
        {
          id: 'some-logged-out-link-1',
          link: 'some-logged-out-link-1-link',
          name: 'some-logged-out-link-1-name',
        },
        {
          id: 'some-external-3',
          link: 'some-external-3-link',
          name: 'some-external-3-name',
        },
        {
          id: 'some-logged-out-link-2',
          link: 'some-logged-out-link-2-link',
          name: 'some-logged-out-link-2-name',
        },
      ],
      logo: {
        label: 'Mercado Libre',
        searchFocus: undefined,
        url: 'https://centrodeproveedores.mercadolibre.com',
      },
      logoAsideText: 'Proveedores',
      melilab: {
        isEnabled: true,
        isMobile: false,
        labUrl: 'https://www.mercadolibre.com.ar/gz/labs',
        melilab: {
          isEnabled: false,
          isMobile: false,
          labUrl: 'https://www.mercadolibre.com/gz/labs',
          melilab: null,
        },
      },
      myAccountText: 'Mi cuenta',
      siteId: 'MLA',
      type: undefined,
      user: {
        active: true,
        admin: false,
        id: 447469951,
        nickname: 'TETE8074471',
        operator: false,
        operatorId: null,
        owner: true,
        raw: {
          address: {},
          alternative_phone: {},
          bill_data: {},
          buyer_reputation: {},
          company: {},
          context: {},
          country_id: 'AR',
          credit: {},
          gender: '',
          id: 447469951,
          identification: {

          },
          internal_tags: [
            '',
          ],
          logo: null,
          nickname: 'TETE8074471',
          permalink: 'http://perfil.mercadolibre.com.ar/TETE8074471',
          phone: {
          },
          points: 100,
          registration_date: '2019-06-27T10:37:33.000-04:00',
          secure_email: 'ttest.83jfqv@mail.mercadolibre.com',
          seller_experience: 'ADVANCED',
          seller_reputation: {

          },
          shipping_modes: [
            'value',
          ],
          site_id: 'MLA',
          status: {

          },
          tags: [
            'value',
          ],
          user_type: 'normal',
        },
        rootId: 447469951,
        scopes: [
          'read',
          'write',
        ],
      },
    });
  });
});

