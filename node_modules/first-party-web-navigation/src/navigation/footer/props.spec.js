const footerProps = require('./props');

const baseProps = {
  platform: {
    siteId: 'MLA',
    id: 'ML',
    domain: 'www.mercadolibre.com',
  },
  device: {
    type: 'desktop',
    mobile: false,
    tablet: false,
    desktop: true,
    forced: false,
    originalType: 'desktop',
  },
  feConfigEnvironment: 'test',
  protocol: 'https',
  headers: {
    host: 'dev.mercadolibre.com:8443',
  },
  urls: {
    baseDomain: { link: 'https://www.mercadolibre.com.ar' },
  },
  labels: {
    headTitle: 'Mercado Libre',
    companyName: 'Mercado Libre',
    copyrightSince: '1999',
    mobileAppsStore: {
      ios: 'https://itunes.apple.com/es/app/id463624852',
      android: 'https://play.google.com/store/apps/details?id=com.mercadolibre',
    },
  },
  user: {
    id: 447469951,
    nickname: 'TETE8074471',
    active: true,
    scopes: ['read', 'write'],
    operator: false,
    operatorId: null,
    rootId: 447469951,
    admin: false,
    owner: true,
    raw: {
      id: 447469951,
      nickname: 'TETE8074471',
      registration_date: '2019-06-27T10:37:33.000-04:00',
      gender: '',
      country_id: 'AR',
      identification: {},
      internal_tags: [''],
      address: {},
      phone: {},
      alternative_phone: {},
      user_type: 'normal',
      tags: ['value'],
      logo: null,
      points: 100,
      site_id: 'MLA',
      permalink: 'http://perfil.mercadolibre.com.ar/TETE8074471',
      shipping_modes: ['value'],
      seller_experience: 'ADVANCED',
      bill_data: {},
      seller_reputation: {},
      buyer_reputation: {},
      status: {},
      secure_email: 'ttest.83jfqv@mail.mercadolibre.com',
      company: {},
      credit: {},
      context: {},
    },
  },
  melilab: {
    labUrl: 'https://www.mercadolibre.com/gz/labs',
    isEnabled: false,
    melilab: null,
    isMobile: false,
  },
  isLoggedIn: true,
};

jest.mock('first-party-navigation-config', () => ({
  getValue: jest.fn().mockImplementation(({ key }) => {
    const hash = {
      firstParty: {
        desktopFooterLinks: [
          'some-1p-config',
          'some-external',
          'some-other-1p-config',
        ],
      },
      url: {
        'some-1p-config': {
          link: 'some-1p-link',
          name: 'some-1p-name',
        },
        'some-other-1p-config': {
          link: 'some-other-1p-link',
          name: 'some-other-1p-name',
        },
      },
    };

    return hash[key];
  }),
}));

jest.mock('frontend-config', () => ({
  get: jest.fn().mockImplementation((key) => {
    const hash = {
      url: {
        'some-external': {
          link: 'some-external-link',
          name: 'some-external-name',
        },
      },
      companyName: 'MercadoLibre S.R.L.',
    };

    return hash[key];
  }),
}));

describe('FP Footer Props', () => {
  it('returns correct footer props for FP', () => {
    const result = footerProps(baseProps);
    const currentYear = new Date().getFullYear();
    expect(result).toEqual({
      isDesktop: true,
      links: [
        {
          link: 'some-1p-link',
          name: 'some-1p-name',
        },
        {
          link: 'some-external-link',
          name: 'some-external-name' },
        {
          link: 'some-other-1p-link',
          name: 'some-other-1p-name',
        },
      ],
      texts: {
        copyright: `Copyright Â© ${currentYear} MercadoLibre S.R.L.`,
      },
    });
  });
});

