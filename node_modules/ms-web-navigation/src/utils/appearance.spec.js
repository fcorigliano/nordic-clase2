const Appearance = require('./appearance');

const appearance = {
  component: 'Document',
  properties: {
    styles: ['http://example.com/'],
  },
  children: [
    {
      component: 'Header',
      properties: {
        raw: "<div class=flash-component><h3 class=flash-component__text>¡HOT SALE! ENVÍOS GRATIS A PARTIR DE $3999 CON MERCADO PUNTOS</h3><a class=flash-component__link href=#section-info>Conocer más</a></div><header class='nav-header nav-header--fixed nav-header--with-flash'itemid=#this itemscope itemtype=http://schema.org/Store role=banner><div class=nav-header__bounds><h1 class=nav-header__title><a class=nav-header__logo href=/ id=logo-wrapper><span class=nav-header__title-hidden></span> <img alt=''class=nav-header__image itemprop=logo src=https://mla-s1-p.mlstatic.com/824623-MLA28741847885_112018-A.jpg></a></h1><hr class=nav-header__separator><input class=nav-header__bar-switch id=search-bar-switch aria-controls=search-bar-switcher type=checkbox><form class=search-form novalidate><button class=search-form__search-button type=submit><i class='nav-header__nav-icon search-form__search-icon'></i></button> <input class=search-form__input id=search-bar autocomplete=' off'placeholder=Buscar... required> <label class='nav-header__nav-icon search-form__close-icon'for=search-bar-switch id=search-bar-switcher></label> <button class=search-form__reset-button type=reset id=reset-search-button><i class='nav-header__nav-icon search-form__reset-icon'id=reset-search-input></i></button></form><ul class='nav-list nav-list--horizontal'itemscope itemtype=http://schema.org/SiteNavigationElement id=nav-list></ul><nav class=nav-header__nav-icons><label class='nav-header__nav-link nav-header__bar-switcher-open'for=search-bar-switch><i class='nav-header__nav-icon nav-header__nav-icon--search'><span>Buscar</span></i></label> <a class=nav-header__nav-link href=/contacto rel=nofollow><i class='nav-header__nav-icon nav-header__nav-icon--contact'><span>Contáctanos</span> </i></a><a class='nav-cart nav-cart-empty'href=/gz/cart id=nav-cart title=Carrito><i class=nav-icon-cart></i> <span class=nav-icon-cart-quantity></span> </a><input class=nav-header__switch id=mobile-categories-menu-switch aria-controls=side-drawer__content type=checkbox><aside class=side-drawer><div class=side-drawer__title><label class=side-drawer__switcher-close for=mobile-categories-menu-switch><h1 class=nav-header__title><a class=nav-header__logo href=/ id=logo-wrapper><span class=nav-header__title-hidden></span> <img alt=''class=nav-header__image itemprop=logo src=https://mla-s1-p.mlstatic.com/824623-MLA28741847885_112018-A.jpg></a></h1></label></div><ul class='nav-list nav-list--vertical'itemscope itemtype=http://schema.org/SiteNavigationElement></ul></aside><label class='nav-header__nav-link nav-header__switcher-open'for=mobile-categories-menu-switch><span class='nav-header__hamburger nav-header__hamburger--top-bread'></span> <span class='nav-header__hamburger nav-header__hamburger--patty'></span> <span class='nav-header__hamburger nav-header__hamburger--bottom-bread'></span></label></nav></div></header><div class=nav-header__banner><div class=nav-header__banner-image itemscope itemtype=http://schema.org/ImageObject style=background-image:url(http://mlm-s1-p.mlstatic.com/622628-MLM26936992402_032018-F.jpg)></div></div>",
        widgets: [
          {
            key: 'search-box',
            src: 'resources/frontend/statics/ms-widgets/searchbox/v0.1.1/searchbox.js',
            code: "new SearchboxWidget({ homeUrl: 'www.google.com' });",
          },
          {
            key: 'responsive-menu',
            src: 'resources/frontend/statics/ms-widgets/responsive-nav-menu/v1.0.1/responsive-nav-menu.js',
            code: "new ResponsiveMenuWidget({model:[{id:'MLA1648',name:'Computación',url:'https://4krcstore.mercadoshops.com.ar/computacion/computacion/'},{id:'MLA1574',name:'Hogar, Muebles y Jardín',url:'https://4krcstore.mercadoshops.com.ar/hogar/'},{id:'MLA1051',name:'Celulares y Teléfonos',url:'https://4krcstore.mercadoshops.com.ar/telefonia/'},{id:'MLA1000',name:'Electrónica, Audio y Video',url:'https://4krcstore.mercadoshops.com.ar/electronica/'},{id:'MLA1499',name:'Industrias y Oficinas',url:'https://4krcstore.mercadoshops.com.ar/listado/industrias-oficinas/'},{id:'MLA1276',name:'Deportes y Fitness',url:'https://4krcstore.mercadoshops.com.ar/deportes/'},{id:'MLA1144',name:'Consolas y Videojuegos',url:'https://4krcstore.mercadoshops.com.ar/videojuegos/'},{id:'MLA1132',name:'Juegos y Juguetes',url:'https://4krcstore.mercadoshops.com.ar/juegos-juguetes/'},{id:'MLA1039',name:'Cámaras y Accesorios',url:'https://4krcstore.mercadoshops.com.ar/camaras-digitales/camaras-accesorios/'},{id:'MLA1182',name:'Instrumentos Musicales',url:'https://4krcstore.mercadoshops.com.ar/instrumentos/'},{id:'MLA1182',name:'Instrumentos Musicales',url:'https://4krcstore.mercadoshops.com.ar/instrumentos/'},{id:'MLA1182',name:'Instrumentos Musicales',url:'https://4krcstore.mercadoshops.com.ar/instrumentos/'},{id:'MLA1182',name:'Instrumentos Musicales',url:'https://4krcstore.mercadoshops.com.ar/instrumentos/'},{id:'MLA1182',name:'Instrumentos Musicales',url:'https://4krcstore.mercadoshops.com.ar/instrumentos/'},{id:'MLA1182',name:'Instrumentos Musicales',url:'https://4krcstore.mercadoshops.com.ar/instrumentos/'},{id:'MLA1182',name:'Instrumentos Musicales',url:'https://4krcstore.mercadoshops.com.ar/instrumentos/'},{id:'MLA1182',name:'Instrumentos Musicales',url:'https://4krcstore.mercadoshops.com.ar/instrumentos/'}]});",
          },
        ],
      },
    },
    {
      component: 'Footer',
      properties: {
        raw: "<div itemtype='http://schema.org/Store' itemid='#this' itemscope=''><div class='nav-footer-contact'> <div class='nav-footer-contact-content'> <div class='nav-bounds nav-bounds--contact nav-bounds-large'> <div class='nav-footer-contact-col'><h3 class='nav-footer-contact-title'><a href='/contacto'>Contacto</a></h3> <div> <ul itemtype='http://schema.org/ContactPoint' itemprop='contactPoint' itemscope=''><li class='contact-mail'> <a itemprop='email' href='mailto:cliente-ml@norauto.com.ar' rel='nofollow'>cliente-ml@norauto.com.ar</a> </li><li class='contact-phone-number'> <a itemprop='telephone' href='tel:+54541146998900' rel='nofollow'>(54) 1146998900</a></li><meta itemprop='contactType' content='customer service'/></ul></div></div><div class='nav-footer-contact-col'> <ul class='nav-footer-social-links'> <li class='nav-footer-social-links-container'> <a class='nav-footer-social-link-item' href='https://www.facebook.com/norautoargentina' target='_blank' rel='noopener noreferrer' itemprop='sameAs'></a><a class='nav-footer-social-link-item' href='https://www.instagram.com/norauto_ar' target='_blank' rel='noopener noreferrer' itemprop='sameAs'></a> </li></ul> </div></div></div></div><footer role='contentinfo' class='nav-footer '> <div class='nav-bounds nav-bounds--copyright'> <div class='nav-footer-primaryinfo'> <small class='nav-footer-copyright'><div class='nav-footer-disclaimer'><p>Powered by Mercado Shops</p><a href='http://qr.afip.gob.ar/?qr=WFKi9hfs2zg13XPgou0HZw,,' target='_F960AFIPInfo'><img src='https://http2.mlstatic.com/resources/frontend/web-homes/ui-dist/images/data-fiscal-6dc7613071.png' class='nav-footer-afip-img' alt='Data fiscal'/></a></div></small> </div></div></footer></div>",
      },
    },
  ],
};

describe('Appearance Wrapper', () => {
  const appearanceObject = new Appearance(appearance);
  it('should return an object with the correct shape', () => {
    expect(appearanceObject).toMatchObject({ appearance });
  });

  it('should return the required property', () => {
    const rawHeader = appearanceObject.getComponentProperty('Header', 'raw');
    const HeaderComponent = appearance.children.find(({ component }) => component === 'Header');
    const expectedValue = HeaderComponent && HeaderComponent.properties.raw;
    expect(rawHeader).toMatch(expectedValue);
  });

  it("should return undefined when the property doesn't exists", () => {
    const nothing = appearanceObject.getComponentProperty('Header', 'row');
    expect(nothing).toBeUndefined();
  });

  it('should return the properties from a component', () => {
    const properties = appearanceObject.getComponentProperties('Header');
    const HeaderComponent = appearance.children.find(({ component }) => component === 'Header');
    const expectedValue = HeaderComponent && HeaderComponent.properties;
    expect(properties).toMatchObject(expectedValue);
  });

  it("should return null when the component doesn't exists", () => {
    const nothing = appearanceObject.getComponentProperty('Heder');
    expect(nothing).toBeNull();
  });

  it('should return the properties from a component', () => {
    const properties = appearanceObject.getComponentProperties('Header');
    const HeaderComponent = appearance.children.find(({ component }) => component === 'Header');
    const expectedValue = HeaderComponent && HeaderComponent.properties;
    expect(properties).toMatchObject(expectedValue);
  });

  it('should return a component', () => {
    const Header = appearanceObject.getComponentByName('Header');
    const expectedValue = appearance.children.find(({ component }) => component === 'Header');
    expect(Header).toMatchObject(expectedValue);
  });

  it("should return a null if the component doesn't exists", () => {
    const component = appearanceObject.getComponentByName('Head');
    expect(component).toBeNull();
  });

  it('should return the value from a property', () => {
    const properties = appearanceObject.getComponentProperties('Header');
    const HeaderComponent = appearance.children.find(({ component }) => component === 'Header');
    const raw = appearanceObject.navigateToProperty(properties, 'raw');
    const expectedValue = HeaderComponent && HeaderComponent.properties.raw;
    expect(raw).toMatch(expectedValue);
  });

  it("should return the null when there's no props", () => {
    const raw = appearanceObject.navigateToProperty();
    expect(raw).toBeNull();
  });
});
