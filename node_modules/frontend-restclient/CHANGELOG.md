# Changelog

## Next Release


## 4.7.2

- [#67](https://github.com/mercadolibre/fury_frontend-restclient/pull/67) Add catch to cache set for cache not available

## 4.7.1

- [#65](https://github.com/mercadolibre/fury_frontend-restclient/pull/65) Add missing `delete` method type definition

## 4.7.0

- [#63](https://github.com/mercadolibre/fury_frontend-restclient/pull/63) Add config to avoid log errors

## 4.6.4

- [#61](https://github.com/mercadolibre/fury_frontend-restclient/pull/61) Fix requestHook docs and add missing type definitions

## 4.6.3

- [#60](https://github.com/mercadolibre/fury_frontend-restclient/pull/60) Update docs for stream use-case.

## 4.6.2

- [#58](https://github.com/mercadolibre/fury_frontend-restclient/pull/58) Log request error for all status codes in development

## 4.6.1

- [#56](https://github.com/mercadolibre/fury_frontend-restclient/pull/56) Fix `context` property being required in browser in type declarations
- [#55](https://github.com/mercadolibre/fury_frontend-restclient/pull/55) Fix baseURL generated in browser when path ends with slash `/`

## 4.6.0

- [#53](https://github.com/mercadolibre/fury_frontend-restclient/pull/53) Remove newrelic transaction instrumentation added in PR [#48](https://github.com/mercadolibre/fury_frontend-restclient/pull/48)

## 4.5.0

- [#50](https://github.com/mercadolibre/fury_frontend-restclient/pull/50) Transform the default headers added in PR [#46](https://github.com/mercadolibre/fury_frontend-restclient/pull/46) to lower case.

## 4.4.0

- [#44](https://github.com/mercadolibre/fury_frontend-restclient/pull/44) Introduce retry policies: TransportRetryPolicy, IdempotentTimeoutPolicy, ServerErrorPolicy, NonIdempotentPolicy and CustomUserPolicy.
- [#45](https://github.com/mercadolibre/fury_frontend-restclient/pull/45) Introduce request and response hooks
- [#46](https://github.com/mercadolibre/fury_frontend-restclient/pull/46) Introduce new default headers: user-agent and accept-encoding.
- [#48](https://github.com/mercadolibre/fury_frontend-restclient/pull/48) Introduce newrelic transaction instrumentation with custom attributes "method" and "target".

## 4.3.0
- [#41](https://github.com/mercadolibre/fury_frontend-restclient/pull/41) Improvement - Disable x-csrf-token header by config.

## 4.2.2
- [#40](https://github.com/mercadolibre/fury_frontend-restclient/pull/40) Fix - Set req.user.admin as false when is undefined.
- 
## 4.2.1
- [#37](https://github.com/mercadolibre/fury_frontend-restclient/pull/37) Fix - Send headers for impersonal sessions only if values exists. 

## 4.2.0

- [#28](https://github.com/mercadolibre/fury_frontend-restclient/pull/28) We need to always add the headers for impersonal sessions and ensure their value is assigned.

## 4.1.0

- [#20](https://github.com/mercadolibre/fury_frontend-restclient/pull/20) x-meli-detached-id and x-meli-impersonated-session are being setted on buildRestClientContext from req.userSession when they are no present on req.headers
- [#18](https://github.com/mercadolibre/fury_frontend-restclient/pull/18) Add type declarations for TS and named exports

## 4.0.2

- [#15](https://github.com/mercadolibre/fury_frontend-restclient/pull/15) CSRF By Default: Add x-csrf-token default header to all browser http calls.

## 4.0.1

- [#16](https://github.com/mercadolibre/fury_frontend-restclient/pull/16) Update @meli/node-caches

## 4.0.0

- [#13](https://github.com/mercadolibre/fury_frontend-restclient/pull/13) Node 14 and module dependencies update

## 3.3.1

- [#9](https://github.com/mercadolibre/fury_frontend-restclient/pull/9)  FIX: mergeContextHeaders: increment `traffic.forwarded_header_diff` metric only for headers whose value is different than in trace headers array.

## 3.3.0

- [#3](https://github.com/mercadolibre/fury_frontend-restclient/pull/3) Added fallback to getFileName in case getEvalOrigin doesn't work on appMetrics.js

### ðŸ’¥ Possible breaking change at dev environments

- [#4](https://github.com/mercadolibre/fury_frontend-restclient/pull/4) Change <http://api.internal.ml.com> by <https://internal-api.mercadolibre.com>.

  When installing this version you have to change the ocurrences of <http://api.internal.ml.com> by <https://internal-api.mercadolibre.com>.

  It can be found in:

  - **The mock intercepts configuration:**
    In the CI environment there is no way out to the Meli cloud, so the tests must always run on mocks. These mocks are usually configured with intercepts to the baseUrl of the api to be mocked and as it is mocked in the development environment, the url used is the one mentioned above, affected by the change.

  - **In the names of the folders of the mocks:**
    The mocks are stored in folders whose name includes the baseUrl of the mocked api. Also remember to update the `http` folder that contains the api.internal.com folder by `https`

  You can guide yourself with this [example Pull Request](https://github.com/mercadolibre/fury_homes-palpatine/pull/1333) in which we make the update in the Mercado Libre Home application.

## 3.2.1

- [#87](https://github.com/mercadolibre/frontend-restclient/pull/87) Make all headers lowercase, fixing header casing error with nock

## 3.2.0

- [#86](https://github.com/mercadolibre/frontend-restclient/pull/86) Add entrypoints of furycache and kvscache to files property of package.json
- [#85](https://github.com/mercadolibre/frontend-restclient/pull/85) Fix: Make new request when getFromCache fail or data is not cached.

## 3.1.0

- [#81](https://github.com/mercadolibre/frontend-restclient/pull/81) Build context: avoid forward headers that were specified as forwardable but do not exist in the request.

## 3.0.0

- Update nordic-axios to [v3.0.0](https://github.com/mercadolibre/frontend-axios/releases/tag/v3.0.0) (Skip JSON parsing validation on empty payloads)
- [#77](https://github.com/mercadolibre/frontend-restclient/pull/77) Small syntax fix on README.md
- Revert "Update nordic-axios to 2.0.1" since it should have been a major version

## ~2.10.1~ - Unpublished

- [#78](https://github.com/mercadolibre/frontend-restclient/pull/78) Update nordic-axios to 2.0.1 (rejects on JSON parsing error)
- [#77](https://github.com/mercadolibre/frontend-restclient/pull/77) Small syntax fix on README.md

## 2.10.0

- [#64](https://github.com/mercadolibre/frontend-restclient/pull/64) Update dependencies
- [#73](https://github.com/mercadolibre/frontend-restclient/pull/73) Feature: Add x-retry-count header

## 2.9.0

- [#66](https://github.com/mercadolibre/frontend-restclient/pull/66) Feature: Add x-cache header with HIT or MISS value
- [#69](https://github.com/mercadolibre/frontend-restclient/pull/69) Fix: Return LRU Cache class instead of an instance of it
- [#70](https://github.com/mercadolibre/frontend-restclient/pull/70) Fix require to node-caches in cache.js file

## 2.8.2

- [#67](https://github.com/mercadolibre/frontend-restclient/pull/67) Fix: Update version of @meli/node-caches. Remove the circular dependency between this module and the kvs client

## 2.8.1

- [#63](https://github.com/mercadolibre/frontend-restclient/pull/63) Fix: Fixes an error on the KVS services that logged an error if the key didn't exist

## 2.8.0

- [#61](https://github.com/mercadolibre/frontend-restclient/pull/61) Feature: Implement node-caches module

## 2.7.0

- [#49](https://github.com/mercadolibre/frontend-restclient/pull/49) Feature: ETag header caching
- [#51](https://github.com/mercadolibre/frontend-restclient/pull/51) Unit tests: Uses the same server for other UTs

## 2.6.1

- [#56](https://github.com/mercadolibre/frontend-restclient/pull/56) Fix: Retry Header always sent on 0

## 2.6.0

- [#54](https://github.com/mercadolibre/frontend-restclient/pull/54) Fix: X-Retry header
- [#53](https://github.com/mercadolibre/frontend-layout/pull/53) Feature: Improved retry log
- [#52](https://github.com/mercadolibre/frontend-layout/pull/52) Implementar cambios en el restclient por trazabilidad

## Check for previous history in the [repo release tags](https://github.com/mercadolibre/frontend-restclient/releases)
