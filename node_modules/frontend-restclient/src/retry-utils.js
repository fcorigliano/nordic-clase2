const { RETRY_COUNT } = require('./constants/headers');

const injectResponseHeadersIfApplies = (res) => {
  if (!res.headers) {
    res.headers = {};
  }
};

const injectRetryCountHeader = (res, count) => {
  injectResponseHeadersIfApplies(res);
  res.headers[RETRY_COUNT] = count;
  return res;
};

const setRetryCountHeaderValueOrDefault = (res) => {
  injectResponseHeadersIfApplies(res);
  res.headers[RETRY_COUNT] = res.headers[RETRY_COUNT] || 0;
  return res;
};

/**
 * Expose retry utils
 */
module.exports = {
  injectRetryCountHeader,
  setRetryCountHeaderValueOrDefault,
};
