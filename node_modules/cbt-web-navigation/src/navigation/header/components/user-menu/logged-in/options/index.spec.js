const React = require('react');
const ShallowRenderer = require('react-test-renderer/shallow');
const LoggedInOptions = require('.');

const baseProps = {
  myAccountText: 'My account',
  showSiteSwitch: true,
  logoutUrl: 'https://www.mercadolibre.com/jms/cbt/lgz/logout?go=https%3A%2F%2Fdev.global-selling.mercadolibre.com%3A8443%2F',
  logoutText: 'Log out',
  cbtInfo: {
    siteUsers: [
      {
        user_id: 463163127,
        site_id: 'MLA',
        status: 'active',
        enabled_sites: [
          'MLA',
        ],
        parent_id: 462143006,
        logistic_type: 'remote',
        site_users: null,
      },
      {
        user_id: 463166651,
        site_id: 'MLB',
        status: 'active',
        enabled_sites: [
          'MLB',
        ],
        parent_id: 462143006,
        logistic_type: 'remote',
        site_users: null,
      },
      {
        user_id: 463163332,
        site_id: 'MLM',
        status: 'active',
        enabled_sites: [
          'MLM',
        ],
        parent_id: 462143006,
        logistic_type: 'remote',
        site_users: null,
      },
    ],
    siteUserId: 463163127,
    currentSiteId: 'MLA',
  },
  logisticType: 'remote',
  sites: {
    MLA: {
      text: 'Argentina',
      countryId: 'AR',
      flag: 'https://http2.mlstatic.com/storage/cbt-statics/layout/header/flags/Argentina.svg',
    },
    MLM: {
      text: 'Mexico',
      countryId: 'MX',
      flag: 'https://http2.mlstatic.com/storage/cbt-statics/layout/header/flags/Mexico.svg',
    },
    MLB: {
      text: 'Brazil',
      countryId: 'BR',
      flag: 'https://http2.mlstatic.com/storage/cbt-statics/layout/header/flags/Brazil.svg',
    },
    MCO: {
      text: 'Colombia',
      countryId: 'CO',
      flag: 'https://http2.mlstatic.com/storage/cbt-statics/layout/header/flags/Colombia.svg',
    },
    MLC: {
      text: 'Chile',
      countryId: 'CL',
      flag: 'https://http2.mlstatic.com/storage/cbt-statics/layout/header/flags/Chile.svg',
    },
  },
  logisticTypes: {
    remote: '',
    '3pl': '(Warehouse)',
    fulfillment: '(Full)',
  },
};

describe('CBT Navigation', () => {
  describe('User Menu Logged In Options', () => {
    it('matches the default snapshot and returns logged in options with site switcher', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <LoggedInOptions
          {...baseProps}
        />
      );

      const renderedComponent = renderer.render(component);
      expect(renderedComponent).toMatchSnapshot();
    });

    it('matches the default snapshot and returns logged in menu without site switcher', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <LoggedInOptions
          {...baseProps}
          showSiteSwitch={false}
        />
      );

      const renderedComponent = renderer.render(component);
      expect(renderedComponent).toMatchSnapshot();
    });
  });
});
