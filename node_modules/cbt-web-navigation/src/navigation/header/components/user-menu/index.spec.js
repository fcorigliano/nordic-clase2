const React = require('react');
const ShallowRenderer = require('react-test-renderer/shallow');
const UserMenu = require('.');

const baseProps = {
  isLoggedIn: true,
  user: {
    id: 462143006,
    nickname: 'GOMITASCARAMELOSDELCENTROSA',
    active: true,
  },
  navigationPIIData: {
    userName: 'Gomitas',
  },
  links: {
    myAccount: {
      name: 'My account',
      link: 'https://global-selling.mercadolibre.com',
    },
    login: {
      name: 'Log in',
      link: 'https://www.mercadolibre.com/jms/cbt/lgz/login?go=https%3A%2F%2Fdev.global-selling.mercadolibre.com%3A8443%2F',
    },
    logout: {
      name: 'Log out',
      link: 'https://www.mercadolibre.com/jms/cbt/lgz/logout?go=https%3A%2F%2Fdev.global-selling.mercadolibre.com%3A8443%2F',
    },
  },
  sites: {
    MLA: {
      text: 'Argentina',
      countryId: 'AR',
      flag: 'https://http2.mlstatic.com/storage/cbt-statics/layout/header/flags/Argentina.svg',
    },
    MLM: {
      text: 'Mexico',
      countryId: 'MX',
      flag: 'https://http2.mlstatic.com/storage/cbt-statics/layout/header/flags/Mexico.svg',
    },
    MLB: {
      text: 'Brazil',
      countryId: 'BR',
      flag: 'https://http2.mlstatic.com/storage/cbt-statics/layout/header/flags/Brazil.svg',
    },
    MCO: {
      text: 'Colombia',
      countryId: 'CO',
      flag: 'https://http2.mlstatic.com/storage/cbt-statics/layout/header/flags/Colombia.svg',
    },
    MLC: {
      text: 'Chile',
      countryId: 'CL',
      flag: 'https://http2.mlstatic.com/storage/cbt-statics/layout/header/flags/Chile.svg',
    },
  },
  logisticTypes: {
    remote: '',
    '3pl': '(Warehouse)',
    fulfillment: '(Full)',
  },
  cbtInfo: {
    siteUsers: [
      {
        user_id: 463163127,
        site_id: 'MLA',
        status: 'active',
        enabled_sites: [
          'MLA',
        ],
        parent_id: 462143006,
        logistic_type: 'remote',
        site_users: null,
      },
      {
        user_id: 463166651,
        site_id: 'MLB',
        status: 'active',
        enabled_sites: [
          'MLB',
        ],
        parent_id: 462143006,
        logistic_type: 'remote',
        site_users: null,
      },
      {
        user_id: 463163332,
        site_id: 'MLM',
        status: 'active',
        enabled_sites: [
          'MLM',
        ],
        parent_id: 462143006,
        logistic_type: 'remote',
        site_users: null,
      },
    ],
    siteUserId: 463163127,
    currentSiteId: 'MLA',
  },
};

describe('CBT Navigation', () => {
  describe('User Menu', () => {
    it('matches the default snapshot and returns menu for logged in user with switcher', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <UserMenu
          {...baseProps}
        />
      );

      const renderedComponent = renderer.render(component);
      expect(renderedComponent).toMatchSnapshot();
    });

    it('matches the default snapshot and returns guest menu', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <UserMenu
          {...baseProps}
          isLoggedIn={false}
        />
      );

      const renderedComponent = renderer.render(component);
      expect(renderedComponent).toMatchSnapshot();
    });
  });
});
