const factory = require('@frontend-navigations/commons/prepare-to-render/services/navigation-pii-data-factory');
const { entityTypes } = require('@frontend-navigations/commons/constants/pii');
const logger = require('../logger');

module.exports = factory({
  logger,
  userProperties: {
    names: {
      preferred: true,
      brand: true,
    },
    entity_type: true,
  },
  mapper: (piiData) => {
    const piiDataWithDefault = piiData || {};
    const namesWithDefault = piiDataWithDefault.names || {};
    const isUserPerson = piiDataWithDefault.entity_type === entityTypes.person;
    return {
      userName: (!isUserPerson && namesWithDefault.brand) || namesWithDefault.preferred,
    };
  },
});
