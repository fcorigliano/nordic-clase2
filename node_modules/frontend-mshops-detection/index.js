/**
 * Module dependencies
 */
const config = require('./src/config');

const fetchShopData = require('./src/middlewares/fetch-shop-data');
const { catchSessionCookies, isGuestDetection } = require('./src/middlewares/is-guest-detection');

const middlewares = [
  config.features.fetchShopData.enabled && fetchShopData,
  ...config.features.guestDetection.enabled ? [catchSessionCookies, isGuestDetection] : [],
].filter(Boolean);

/**
 * Expose middleware
 */
module.exports = middlewares;
