import type { CsrPrerenderConfig } from 'frontend-csr-prerender';
import type { RequestHandler, Request, Response } from 'express';

export interface DeeplinkConfigOptions {
 /**
   * A deeplink url
   */
  deeplink: string;
}

export interface ConfigOptions {
  /**
   * Function used to configure preloads and prefetches
   * @see https://github.com/mercadolibre/fury_frontend-csr-prerender
   */
  csrPrerender?: CsrPrerenderConfig;
  /**
   * Function used to configure deeplink
   * @param request an Express request
   * @param response an Express response
   * @return a deeplink configuration object
   * @default () => {}
   */
  deeplink?: (req: Request, res: Response) => DeeplinkConfigOptions;
  /**
   * Configurable object for enabling deeplink or csrPrerender middlewares
   * @default { deeplink: false, csrPrerender: false }
   */
  middlewares?: {
    deeplink?: boolean;
    csrPrerender?: boolean;
  };
}

/**
 * Middleware used to configure webviews
 * @param options a configuration object
 * @return An express request handler
 */
export const webviewsMiddleware: (options?: ConfigOptions) => RequestHandler;
