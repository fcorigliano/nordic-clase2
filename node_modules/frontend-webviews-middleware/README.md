# Webviews Middleware

Este módulo agrupa y administra los middlewares que se necesitan para generar una webview de calidad.
Dentro del módulo podemos encontrar dos middlewares
 1. **Deeplink**: podemos configurar un deeplink según una url específica.
 2. **Middleware CSR Prerender**: mejora la performance en las webviews, utilizando skeleton o contenido estático  [documentación aquí](https://github.com/mercadolibre/fury_frontend-csr-prerender/tree/develop#client-side-rendering-csr-pre-rendering)
 
**Ambos middlewares vienen desactivadas por default**

## Instalación
```
npm install frontend-webviews-middleware
```

### Configuración
Para utilizar los middlewares deberemos encenderlos dentro de la configuración que le enviemos
 
```js
middlewares: {
   deeplink: true,
   csrPrerender: true,
 },
```

Se podrá generar una configuración custom para setear tanto el deeplink como la configuración del middleware de CSR PreRender, dicha configuración es un `function` y recibe como parámetros el request y response para poder tomar las decisiones correspondientes, dicha función debe retornar un objeto como lo explica en el ejemplo más abajo.

`deeplink`: (`object`): Deberá devolver la url del deeplink dentro del parámetro `deeplink`
`csrPrerender`: [documentación](https://github.com/mercadolibre/fury_frontend-csr-prerender/tree/develop#configuraci%C3%B3n)

## Uso

```js
/**
* Module dependencies
*/
const { webviewsMiddleware } = require('frontend-webviews-middleware');

// or legacy way
const webviewsMiddleware = require('frontend-webviews-middleware');


const configWebview = {
 middlewares: {
   deeplink: true,
   csrPrerender: true,
 },
 deeplink: (req, res) => {
   return {
     deeplink: 'meli://deeplink',
   };
 },
 csrPrerender: (req, res) => ({
   prefetches: ['https://www.url.com.ar'],
   preloads: ['https://www.url.com.ar'],
 }),
};

router.get('/', webviewsMiddleware(configWebview), render);

/**
* Expose router
*/
module.exports = router;
```

## License

Copyright © 2019.
