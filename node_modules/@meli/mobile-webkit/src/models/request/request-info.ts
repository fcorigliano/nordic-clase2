import { Config } from "./config";
import { Callback } from "../../utils/callback-container";
import { InternalData } from "./internal-data";
import { ToNativeMessageType } from "../to-native/to-native-message-type";
import { MultipleRequest, Request } from "..";
import { clone } from "../../utils";

export interface RequestInfo extends Config, InternalData {
    message_type: ToNativeMessageType
    method?: string,
    args: any,
    callback?: Callback
}

export function buildRequestInfo(messageType: ToNativeMessageType, req: Request | MultipleRequest, defaultConfig: Config): RequestInfo {
    return {
        message_type: messageType,
        internal_data: {
            current_retry_on_timeout: 0
        },
        ...defaultConfig,
        ...clone(req),
        callback: req.callback,
    };
}