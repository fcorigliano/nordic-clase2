const statsdInternal = require('frontend-statsd/internal');
const {
  FURY,
  PRODUCTION,
} = require('frontend-env');
const { LAYOUT_NAMESPACE } = require('../constants/statsd');

const send = ({
  req,
  key,
  additionalTags = {},
}) => {
  if (FURY && PRODUCTION) {
    const platform = req.platform || {};
    const platformId = platform.id || null;
    const siteId = platform.siteId || null;

    statsdInternal.histogram(`${LAYOUT_NAMESPACE}.${key}`, 1, {
      platformId,
      siteId,
      ...additionalTags,
    });
  }
};

module.exports = {
  send,
};
