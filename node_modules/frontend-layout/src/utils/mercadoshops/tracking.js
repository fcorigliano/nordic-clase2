const React = require('react');
const PropTypes = require('prop-types');
const Script = require('frontend-script');

const Appearance = require('./appearance');

const Tracking = ({ shopModel }) => {
  if (!shopModel || !shopModel.appearance) {
    return null;
  }

  const appearance = new Appearance(shopModel.appearance);
  const widgets = appearance.getComponentProperty('Widgets', 'widgets');

  return Array.isArray(widgets) && widgets.map(({
    key, src, code, priority,
  }) => (
    <Script priority={priority} key={key} src={src}>
      {code}
    </Script>
  ));
};

Tracking.propTypes = {
  shopModel: PropTypes.shape({
    appearance: PropTypes.shape({}),
  }),
};

Tracking.defaultProps = {
  shopModel: null,
};

module.exports = Tracking;
