/**
 * Module dependencies
 */
const feConfig = require('frontend-config');
const { ENABLE_JCORS_LOADER, PRODUCTION } = require('frontend-env');
const { cdnReplace } = require('../../config/head-config');

/**
 * getAssetsConfig
 */
function getAssetsConfig({ cdn, feConfigEnvironment }) {
  const assets = feConfig.get('assets', null, null, feConfigEnvironment) || {};
  const cdnName = cdn && cdn.name;
  return {
    useManifest: typeof assets.useManifest === 'undefined' ? PRODUCTION : assets.useManifest,
    manifest: assets.manifest || 'manifest.json',
    prefix: assets.prefix ? cdnReplace(assets.prefix, cdnName) : '/',
    basePath: assets.basePath || 'build',
    enableJcorsLoading: ENABLE_JCORS_LOADER && JSON.parse(ENABLE_JCORS_LOADER),
  };
}

/**
 * Expose getAssetsConfig
 */
module.exports = getAssetsConfig;
