const React = require('react');
const Head = require('react-declarative-head');
const env = require('frontend-env');
const Script = require('frontend-script');

const A2HS = ({ platform, cdn, browser }) => {
  const lab = env.FURY && env.SCOPE.includes('test');
  const offerA2HSWithoutApplite = browser.name.toLowerCase() === 'chrome' && browser.device.type.toLowerCase() === 'mobile' && browser.major >= 68;
  return (
    <Head>
      <link
        rel="icon"
        sizes="192x192"
        href={`${cdn.link}/ui/navigation/2.0.9/mercadolibre/192x192-android.png`}
      />
      <link
        rel="apple-touch-icon"
        sizes="192x192"
        href={`${cdn.link}/ui/navigation/2.0.9/mercadolibre/192x192-precomposed.png`}
      />
      <link
        rel="manifest"
        href={`https://www.${platform.domain}/manifest${offerA2HSWithoutApplite ? '' : '-applite'}-${platform.siteId}.json`}
        crossOrigin={!env.FURY || lab ? 'use-credentials' : null}
      />
      {offerA2HSWithoutApplite ? null : <Script src={lab ? `https://www.${platform.domain}/a2hs.js` : `${cdn.link}/resources/a2hs.js`} />}
    </Head>
  );
};

module.exports = A2HS;
