const {
  buildContext,
  buildFlowStarterContext,
} = require('frontend-restclient');

/**
 * Fetch json config file located in object storage (sync)
 * @param {string} environment - Selected config environment
 * @param {object} update - Update configuration
 * @param {string} update.path - Request static folder path
 * @param {number} update.request - Request configuration
 * @param {object} restclientInstance - Rest client instance
 * @param {object=} req - Express request
 * @returns {Promise}
 */
const fetchRemoteConfigFile = ({
  environment,
  update,
  restclientInstance,
  req,
}) => restclientInstance.get(`${update.path}/${environment}/configuration.json`, {
  ...update.request,
  context: req ? buildContext(req) : buildFlowStarterContext(),
});
module.exports = { fetchRemoteConfigFile };
