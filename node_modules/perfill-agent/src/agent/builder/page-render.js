const pick = require('../utils/pick');
const { PAGE_RENDER } = require('../../constants/initiatives');
const { HYDRATE_COMPLETE, HYDRATE_DURATION } = require('../../constants/metrics');

const metrics = [HYDRATE_COMPLETE, HYDRATE_DURATION];

const preparePayload = (settings, data) => {
  const pageRenderMetrics = pick(data, metrics);

  if (!Object.keys(pageRenderMetrics).length) {
    throw new Error('Metrics not found');
  }

  return {
    name: PAGE_RENDER,
    data: pageRenderMetrics,
  };
};

module.exports = preparePayload;
