const pick = require('../utils/pick');
const { AVAILABILITY } = require('../../constants/initiatives');
const { AVAILABILITY_FAILURE, AVAILABILITY_TRANSFER_SIZE } = require('../../constants/metrics');

const metrics = [AVAILABILITY_FAILURE, AVAILABILITY_TRANSFER_SIZE];

const preparePayload = (settings, data) => {
  const collection = pick(data, metrics);

  if (!Object.keys(collection).length) {
    throw new Error('Metrics not found');
  }

  return {
    name: AVAILABILITY,
    data: {
      [AVAILABILITY_FAILURE]: collection[AVAILABILITY_FAILURE],
      [AVAILABILITY_TRANSFER_SIZE]: collection[AVAILABILITY_TRANSFER_SIZE],
    },
  };
};

module.exports = preparePayload;
