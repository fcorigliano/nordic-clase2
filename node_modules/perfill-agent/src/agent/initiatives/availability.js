const availabilityMonitor = require('../triggers/availability');
const deviceInformationMonitor = require('../monitors/device-info');
const connectionInformationMonitor = require('../monitors/connection-info');
const { prepareConfiguration } = require('../config');
const browserInformationMonitor = require('../monitors/browser-info');
const availabilityResourcesMonitor = require('../monitors/availability-resources');
const availabilityEntriesMonitor = require('../monitors/availability-entries');
const { supportsBeaconOrFetch } = require('../support');

const start = args => {
  const settings = prepareConfiguration(args);
  if (!settings) {
    return;
  }

  try {
    if (supportsBeaconOrFetch()) {
      deviceInformationMonitor();
      connectionInformationMonitor();
      availabilityMonitor(settings);
      availabilityResourcesMonitor();
      availabilityEntriesMonitor();
      browserInformationMonitor();
    }
    // eslint-disable-next-line no-empty
  } catch (e) {}
};

module.exports = {
  start,
};
