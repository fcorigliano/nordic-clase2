const deviceInformationMonitor = require('../monitors/device-info');
const connectionInformationMonitor = require('../monitors/connection-info');
const navigationTimingMonitor = require('../monitors/navigation-timing');
const perfumeMonitor = require('../monitors/perfume');
const { prepareConfiguration } = require('../config');
const browserInformationMonitor = require('../monitors/browser-info');
const documentContentMonitor = require('../monitors/document-content');

const {
  supportsPerformanceApi,
  supportsBeaconOrFetch,
} = require('../support');

const start = (args, initiative) => {
  const settings = prepareConfiguration(args);
  if (!settings) {
    return;
  }

  try {
    if (supportsPerformanceApi() && supportsBeaconOrFetch()) {
      perfumeMonitor(settings, initiative);
      deviceInformationMonitor();
      connectionInformationMonitor();
      browserInformationMonitor();
      navigationTimingMonitor();
      documentContentMonitor();
    }
    // eslint-disable-next-line no-empty
  } catch (e) {}
};

module.exports = {
  start,
};
