const cdnHealthTrigger = require('../triggers/cdn-health');
const pixelInformationMonitor = require('../monitors/pixel-info');
const deviceInformationMonitor = require('../monitors/device-info');
const connectionInformationMonitor = require('../monitors/connection-info');
const { prepareConfiguration } = require('../config');
const browserInformationMonitor = require('../monitors/browser-info');
const availabilityResourcesMonitor = require('../monitors/availability-resources');
const durationInformationMonitor = require('../monitors/duration-info');
const { supportsBeaconOrFetch } = require('../support');

const start = args => {
  const settings = prepareConfiguration(args);
  if (!settings) {
    return;
  }

  try {
    if (supportsBeaconOrFetch()) {
      pixelInformationMonitor();
      availabilityResourcesMonitor();
      cdnHealthTrigger(settings);
      durationInformationMonitor();
      deviceInformationMonitor();
      connectionInformationMonitor();
      browserInformationMonitor();
    }
    // eslint-disable-next-line no-empty
  } catch (e) {}
};

module.exports = {
  start,
};
