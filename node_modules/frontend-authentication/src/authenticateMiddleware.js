const { resolveUser } = require('./user-resolver');

/**
 * Ensure the user in the current request
 *
 * @type {import('express').RequestHandler}
 */
exports.authenticate = async (req, res, next) => {
  await resolveUser(req, res, { allowWebviewAuthentication: true });
  return next();
};
