# frontend-cdn-metrics

# Table of Contents
- [Description](#description)
- [Usage](#usage)
  - [Install](#install)
  - [As middleware usage](#as-middleware-usage)
  - [As function usage](#as-function-usage)
  - [Controller usage](#controller-usage)
  - [View usage](#view-usage)
  - [Configuration](#configuration)
- [Development](#development)
- [Tests](#tests)
- [Contributing](#contributing)
- [Changelog](#changelog)

## Description

Provide a middleware and client to measure CDN

## Usage

### Install
```
npm install --save frontend-cdn-metrics
```

### As middleware usage
```js
const { cdnMetricsMiddleware } = require('frontend-cdn-metrics');

routes.get('/', cdnMetricsMiddleware, render);
```
`req.cdnMetrics` will be available

### As function usage
```js
const { cdnMetricsFn } = require('frontend-cdn-metrics');

const cdnMetrics = cdnMetricsFn(req, res);
```

### Controller usage
```js
res.render(View, {
  ...
  cdnMetrics: req.cdnMetrics 
});
```

### View usage
```js
const { cdnMetrics } = this.props;

{ cdnMetrics && <Script src={cdnMetrics} /> }
```

### Configuration
Using frontend-config
```js

{
  ML: {
    MLA: {
      cdn: {
        apps: ['app-frontend', 'your-app-name'],
        clientVersion: '0.0.3',
        limitExecution: 3, // How many times it runs, -1 for infinite
        score: 30, // It depends from your _d2id cookie
        maxAge: 3600, // In seconds
      },
    },
  },
};
```

## Development

1) Install dependencies:

```
npm install 
```

2) Build the component:

```
npm run build
```

## Tests
```npm
npm test
```

## Contributing

In order to contribute to this library, you must read [this guide](CONTRIBUTING.md) first.

## Changelog

We keep changes to our codebase [here](CHANGELOG.md)
