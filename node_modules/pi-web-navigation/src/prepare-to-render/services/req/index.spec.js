const reqService = require('./index');

const mockHeader = jest.fn();
const mockGet = jest.fn();

const res = { header: mockHeader, get: mockGet };
const reqParams = {
  headers: 'x-test-navigation-config-environment',
  cookies: 'meliLab',
  platform: { id: 'TEST', siteId: 'SITE-TEST' },
};
const mockReqService = () => reqService({ ...reqParams }, res);

describe('req service test', () => {
  test('req - res methods', () => {
    const service = mockReqService();
    service.res.header('a', 'b');
    expect(mockHeader).toHaveBeenCalledWith('a', 'b');
    service.res.header('a');
    expect(mockHeader).toHaveBeenCalledWith('a');
    service.res.get('a');
    expect(mockGet).toHaveBeenCalledWith('a');
    const { headers, cookies, platform } = service;
    expect(reqParams).toMatchObject({ headers, cookies, platform });
  });
});
