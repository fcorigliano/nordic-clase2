const { getValue } = require('pi-navigation-config');
const liteHeaderProps = require('./lite/props');
const logoProps = require('./components/logo/props');
const meliLabProps = require('./components/meli-lab/props');
const userMenuProps = require('./components/user-menu/props');

const headerProps = (props) => {
  const {
    platform,
    type,
    internal,
    req,
  } = props;

  const iconsForLinks = getValue({ key: 'mobileHeaderMenuIcons', platform, req });

  const linkTagValues = getValue({ key: 'linkTags', platform, req }) || [];
  const linkTags = linkTagValues.reduce((hash, linkTag) => {
    hash[linkTag.linkId] = linkTag;
    return hash;
  }, {});

  return {
    type,
    internal,
    siteId: platform.siteId,
    logo: logoProps(props),
    melilab: meliLabProps(props),
    lite: liteHeaderProps(props),
    userMenu: userMenuProps({
      ...props,
      icons: iconsForLinks,
    }, linkTags),
  };
};

module.exports = headerProps;
