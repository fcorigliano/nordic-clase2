const { getValue } = require('pi-navigation-config');

const id = 'logout';

const enhancement = (url, props) => {
  try {
    const homeUrl = getValue({
      key: 'url.home.link',
      platform: props.platform,
      req: props.req,
    });

    if (!homeUrl) {
      return url;
    }
    const urlObject = new URL(url.link.href);
    if (!urlObject.searchParams.has('go')) {
      urlObject.searchParams.append('go', homeUrl);
    }
    return {
      ...url,
      link: {
        ...url.link,
        href: urlObject.href,
      },
    };
  } catch (e) {
    return url;
  }
};

module.exports = {
  id,
  enhance: enhancement,
};
