# webpack-conformance-plugin

# Table of Contents
- [Description](#description)
- [Usage](#usage)
- [Install](#install)
- [Example](#example)
- [Tests](#tests)
- [Contributing](#contributing)
- [Changelog](#changelog)

## Description

A webpack plugin conformance system for [Nordic](https://nordic.adminml.com), conformance aim to find bad patterns in [Nordic](https://nordic.adminml.com) applications, the system scan all source files and generated assets for forbidden anti patterns and warn(in a near future we will fail) if it does not conform to a preset array of rules.

## Architecture
![webpack-conformance-plugin Architecture](./diagram.png)

## Usage

### Install
```
npm install --save webpack-conformance-plugin
```

### Example
webpack.config.js
```
const { WebpackConformancePlugin } = require('webpack-conformance-plugin');

module.exports = {
  //...
  plugins: [
    new WebpackConformancePlugin({
      // Options
    })
  ],
};
```

### Options

| Name | Description | Type | Default | Required |
| -------- | ----------- | ---- | ------- | -------- |
| `webpackConfig` | Path to webpack config. | string | Current working directory | false |
| `rules` | Array of rules to apply. | array | [[Minification](./lib/rules/minification.js), [Granular Chunking](./lib/rules/granular-chunk.js)] | false |

### Current Rules

#### [Minification Rule](./lib/rules/minification.js)
Minification rule will check for [optimization.minimize](https://webpack.js.org/configuration/optimization/#optimizationminimize), if disabled a warning will be thrown.

#### [Granular Chunking Rule](./lib/rules/granular-chunk.js)
Granular Chunking rule will check for modifications in the frontend-lazy [granular](https://github.com/mercadolibre/fury_frontend-lazy#strategies) strategy, if you don't use this strategy the check will pass, if you use the strategy and changes are detected a warning will be thrown.

### How to create a new rule ?
A rule is a class implementing any of these methods: buildStared,getAstNode, buildCompleted, each method will give you access to a different phase of webpack build.

| Name | Description | Arguments | Return value | Required |
| -------- | ----------- | ---- | ------- | ------- |
| `buildStared` | Executed at the start of the build. | Object (the current webpack config) | undefined | false |
| `getAstNode` | Executed when parsing javascript files. | null | [array of visitors](./lib/rules/image.js) | false |
| `buildCompleted` | Executed at the end of the build. | Object (the list of generated assets) | undefined | false |

For inspiration you can take a look to our rules [folder](./lib/rules)

### Tests
```npm
npm test
```

## Contributing

In order to contribute to this library, you must read [this guide](CONTRIBUTING.md) first.

## Changelog

We keep changes to our codebase [here](CHANGELOG.md)
