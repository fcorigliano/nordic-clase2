const React = require('react');
const Script = require('frontend-script');
const PropTypes = require('prop-types');

// Heads up! We need to add this inline since reading the file won't work
// if we send these components to the frontend, as well as installing this module
// in another repo. The source code is located in ./client.js in order to have this code
// more readable and testeable. If you want to make changes, please make them there and then
// paste them here.
const Snackbar = ({ baseUrl, version }) => {
  const url = `${baseUrl}/frontend-assets/nav-widget-ml-snackbar/v${version}/snackbar.js`;

  return (
    <Script src={url}>
      {
        `
        (function (win, freya) {
          if (win.SnackbarWidget && typeof freya !== 'undefined') {
            new win.SnackbarWidget({
              bus: freya,
            });
          }
        }(window, window.freya));
        `
      }
    </Script>
  );
};

Snackbar.propTypes = {
  baseUrl: PropTypes.string.isRequired,
  version: PropTypes.string,
};

Snackbar.defaultProps = {
  version: '1.1.0',
};

module.exports = Snackbar;
