// eslint-disable-next-line max-len
const mapSectionsLinksToUrls = require('./map-sections-links-to-urls');
const icons = require('./icons');

const originalProps = {
  device: {
    osName: 'android',
  },
  platform: {
    id: 'ML',
    siteId: 'MLA',
  },
};
icons.inject(originalProps);

describe('Mercado Libre Navigation', () => {
  describe('Map Sections Links To Urls', () => {
    it('returns a valid links list with the parsed information', () => {
      const sections = [['home']];
      const urls = {
        home: {
          link: 'https://www.mercadolibre.com.ar',
          name: 'Inicio',
        },
      };
      const actualLocation = 'https://www.mercadolibre.com.ar';

      const links = mapSectionsLinksToUrls({ sectionsLinks: sections, urls, currentUrl: actualLocation, originalProps });

      expect(links).toHaveLength(1);
    });

    it('returns a valid links list with the parsed information and hashLink at the end', () => {
      const sections = [['home']];
      const urls = {
        home: {
          link: 'https://www.mercadolibre.com.ar',
          name: 'Inicio',
        },
      };
      const actualLocation = 'https://www.mercadolibre.com.ar';

      const links = mapSectionsLinksToUrls({
        sectionsLinks: sections,
        urls,
        currentUrl: actualLocation,
        enhancements: {},
        props: {},
        hash: 'hash',
        originalProps,
      });

      expect(links).toHaveLength(1);
      expect(links[0][0].link.href.endsWith('#hash')).toEqual(true);
    });

    it('returns a valid links list minus one that is not a valid link', () => {
      const sections = [['home', 'discounts']];
      const urls = {
        home: {
          link: 'https://www.mercadolibre.com.ar',
          name: 'Inicio',
        },
        discounts: {
          link: null,
          name: 'Ofertas',
        },
      };
      const actualLocation = 'https://www.mercadolibre.com.ar';

      const links = mapSectionsLinksToUrls({ sectionsLinks: sections, urls, currentUrl: actualLocation, originalProps });

      expect(links).toHaveLength(1);
      expect(links[0]).toHaveLength(1);
    });

    it('returns a valid links list with the parsed information and side effects', () => {
      const sections = [['home']];
      const urls = {
        home: {
          link: 'https://www.mercadolibre.com.ar',
          name: 'Inicio',
        },
      };
      const actualLocation = 'https://www.mercadolibre.com.ar';
      originalProps.device.desktop = true;
      const enhancement = {
        enhance: (url, props) => ({ ...url, device: props.device }),
      };

      const links = mapSectionsLinksToUrls({ sectionsLinks: sections, urls, currentUrl: actualLocation, originalProps, enhancements: { home: enhancement } });

      expect(links).toHaveLength(1);
    });
  });
});
