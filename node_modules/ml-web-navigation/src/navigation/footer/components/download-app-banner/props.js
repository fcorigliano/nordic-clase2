const { getValue } = require('ml-navigation-config');
const isDesktop = require('../../../utils/is-desktop');

const downloadBannerProps = (props) => {
  const {
    navigationUrls,
    device,
    req,
    platform,
  } = props;
  const { downloadAppLanding, downloadAppStore } = navigationUrls;

  const appsStore = getValue({
    key: 'mobileAppsStore',
    req,
    platform,
  });
  const isCurrentlyDesktop = isDesktop(props);

  const label = isCurrentlyDesktop
    ? downloadAppLanding && downloadAppLanding.name
    : downloadAppStore && downloadAppStore.name;
  const downloadAppLandingLink = downloadAppLanding && downloadAppLanding.link;

  const link = isCurrentlyDesktop
    ? downloadAppLandingLink
    : appsStore[device.osName] || (downloadAppLandingLink);

  return {
    label,
    link,
    asButton: isCurrentlyDesktop,
    target: isCurrentlyDesktop ? '_blank' : undefined,
  };
};

module.exports = downloadBannerProps;
