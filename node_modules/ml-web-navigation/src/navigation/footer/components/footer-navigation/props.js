/* eslint-disable security/detect-non-literal-fs-filename */
/* eslint-disable security/detect-object-injection */
const { getValue } = require('ml-navigation-config');
const { addLinks } = require('../sites/additional-links');

const navigationProps = (props) => {
  const { navigationUrls, req, platform, device } = props;
  const footerLinksKey = device.mobile ? 'mobileSecondaryFooterLinks' : 'desktopFooterLinks';
  const footerItems = getValue({
    key: footerLinksKey,
    req,
    platform,
  }) || [];
  const links = [];

  footerItems.forEach((item) => {
    const itemId = typeof item.link === 'string' ? item.link : item;
    const urlForItem = navigationUrls[itemId];

    if (urlForItem) {
      links.push({
        href: urlForItem.link,
        name: urlForItem.name,
        id: itemId,
      });
    }
  });

  addLinks(links, props);

  return {
    links,
    isMobile: device.mobile,
  };
};

module.exports = navigationProps;
