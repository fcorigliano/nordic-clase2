const isUserLoggedIn = require('@frontend-navigations/commons/is-user-logged-in');
const { mapLinksToUrls } = require('../../../../utils/links');

const id = 'myAccount';

const getSectionForUser = (isLoggedIn, item) => {
  const links = isLoggedIn ? item.items : item.itemsGuest;

  return links;
};

const userMenuProps = (props, item) => {
  const { urls, configSchema, actualLocation } = props;
  const isLoggedIn = isUserLoggedIn(props);
  const section = getSectionForUser(isLoggedIn, item);

  const userMenuUrls = {
    ...urls,
    myAccount: { ...urls.myAccount, name: configSchema.i18n.myAccountDashboard },
  };

  return mapLinksToUrls({
    links: section,
    urls: userMenuUrls,
    currentUrl: actualLocation,
    originalProps: props,
  });
};

module.exports = {
  id,
  getSectionForUser,
  props: userMenuProps,
};
