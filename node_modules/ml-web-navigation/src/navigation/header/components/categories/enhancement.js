/* eslint-disable security/detect-non-literal-fs-filename */
const classNames = require('classnames');
const CategoriesWidget = require('../../../widgets/categories');
const categoriesWidgetProps = require('../../../widgets/categories/props');

const id = 'categories';

const categoriesEnhancement = (url, props, linkConfig = {}) => {
  const hasWidget = linkConfig.isCategory;

  const className = classNames(
    url.className,
    hasWidget && 'nav-menu-categories-link',
  );

  const SideEffect = hasWidget
    ? CategoriesWidget
    : null;

  const newUrl = { ...url,
    SideEffect,
    ...categoriesWidgetProps(props),
    link: { ...url.link,
      className,
      'data-js': 'nav-menu-categories-trigger' } };

  return newUrl;
};

module.exports = {
  id,
  enhance: categoriesEnhancement,
};
