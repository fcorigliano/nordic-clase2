/* eslint-disable jsx-a11y/label-has-for */
const React = require('react');
const PropTypes = require('prop-types');
const Script = require('frontend-script');
const Image = require('frontend-image');
const Coins = require('./coins');
const readClientFile = require('../../../../../../utils/read-client-file');

const script = readClientFile('mp-header-dropdown-storage.js');

const Melicoins = ({ mercadoPago }) => {
  const namespace = 'user-menu__coins';

  const kycLabel = mercadoPago.kyc !== undefined ? mercadoPago.kyc.label : '';
  const coins = mercadoPago.coins.map((coin, index, array) => (
    <Coins
      id={coin.id}
      index={index}
      array={array}
      icon={coin.icon}
      label={coin.label}
      symbol={coin.symbol}
      units={coin.balance.units}
      cents={coin.balance.cents}
      exchange={coin.exchange}
      variation={coin.variation}
      exchangeRate={coin.exchange_rate}
      currency={coin.currency}
      action={coin.action}
      kyc={mercadoPago.kyc}
    />
  ));
  return (
    <>
      <input
        type="checkbox"
        id={`${namespace}-state`}
        defaultChecked
        hidden
      />
      <div
        id={`${namespace}`}
        htmlFor={`${namespace}-state`}
        className={`${namespace} ${namespace}-mobile`}
      >
        <label
          htmlFor={`${namespace}-state`}
          id={`${namespace}-main`}
          className={`${namespace}-main ${namespace}-main-mobile`}
        >
          <div className={`${namespace}-mp`}>
            <Image
              id={mercadoPago.title.label}
              src={mercadoPago.title.icon}
              alt=""
              className={`${namespace}-icon`}
              onload="off"
            />
            <span className={`${namespace}-title`}>
              {mercadoPago.title.label}
            </span>
          </div>
          <svg
            id={`${namespace}-chevron`}
            className={`${namespace}-chevron  user-menu__coins-chevron-mp`}
            xmlns="http://www.w3.org/2000/svg"
            width="8"
            height="10"
            viewBox="0 0 4 10"
          >
            <path
              id={`${namespace}--chevron`}
              className={`${namespace}--chevron`}
              fill="none"
              fillRule="evenodd"
              strokeWidth="1.5"
              d="M1.017 9.032l4.015-4.024L1.017.983"
            />
          </svg>
        </label>
        <div className="user-menu__coins-info">
          <ul className="user-menu__coins-item-list-mobile">{coins}</ul>

          {mercadoPago.kyc && (
            <a
              href={mercadoPago.kyc.target}
              id="user-menu__coins-kyc"
              className={`${namespace}-kyc-label ${namespace}-kyc-label-mobile ${namespace}-info-link`}
            >
              <p>{kycLabel}</p>
              <svg
                className={`${namespace}-chevron`}
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="10"
                viewBox="0 0 1 10"
                id={`${namespace}-chevron`}
              >
                <path
                  className={`${namespace}-kyc-chevron`}
                  fill="none"
                  fillRule="evenodd"
                  strokeWidth="1.5"
                  d="M1.017 9.032l4.015-4.024L1.017.983"
                />
              </svg>
            </a>
          )}
        </div>

        <Script on="now">{script}</Script>
      </div>
    </>
  );
};
Melicoins.propTypes = {
  mercadoPago: PropTypes.object.isRequired,
};
module.exports = Melicoins;
