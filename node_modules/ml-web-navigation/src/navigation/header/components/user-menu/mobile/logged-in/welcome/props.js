const loyaltyProps = require('../loyalty/props');
const avatarProps = require('../avatar/props');
const mercadoPago = require('../melicoins/props');

const welcomeProps = (props, options = {}) => {
  const { user, navigationPIIData, userInfo, urls } = props;

  const firstName = navigationPIIData.preferredName;

  const baseProps = {
    firstName,
    nickname: user.nickname,
    title: userInfo.title,
    email: navigationPIIData.email,
    hasLoyalty: userInfo && !!userInfo.loyal,
    loyalty: {},
    avatar: avatarProps(props, options),
    mercadoPago: mercadoPago(props),
    domain: urls.mainDomain.link,
  };

  if (baseProps.hasLoyalty) {
    Object.assign(baseProps, {
      loyalty: loyaltyProps(props),
    });
  }

  return baseProps;
};

module.exports = welcomeProps;
