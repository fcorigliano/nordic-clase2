const React = require('react');
const ShallowRenderer = require('react-test-renderer/shallow');
const UserMenu = require('.');

const userLinksSectionsProps = {
  sectionsLinks: [
    [
      {
        link: {
          href: 'https://www.mercadolibre.com.ar',
        },
        name: 'Inicio',
        icon: 'nav-home-icon',
        selected: false,
        id: 'home',
      },
    ],
    [
      {
        link: {
          href: 'https://www.mercadolibre.com.ar/ofertas',
        },
        name: 'Ofertas',
        icon: 'nav-deals-icon',
        selected: false,
        id: 'deals',
      },
    ],
  ],
};

const loggedInWelcomeProps = {
  hasLoyalty: true,
  title: 'Test',
  firstName: 'Test',
  nickname: 'Test',
  email: 'test@test.com',
  loyalty: {
    level: 4,
    href: 'https://www.mercadolibre.com.ar',
    levelName: 'Aficionado',
  },
  avatar: {
    hasPicture: false,
    hasLoyalty: false,
    lazyLoad: 'off',
    loyalty: {
      percentage: 25,
      level: 4,
    },
    action: 'https://www.mercadolibre.com.ar/user/picture',
  },
};

const guestWelcomeProps = {
  title: 'Bienvenido!',
  subtitle: 'Ingresa o registrate',
  login: {
    link: 'https://www.mercadolibre.com.ar/login',
    name: 'Ingresa',
  },
  registration: {
    link: 'https://www.mercadolibre.com.ar/registration',
    name: 'Crea tu cuenta',
  },
};

const baseProps = {
  navMenuSwitchId: 'nav-menu-header-switch',
  isMobile: true,
  isUserLoggedIn: true,
  user: {},
  loggedInMenu: {
    mobile: {
      userLinksSections: userLinksSectionsProps,
      welcome: loggedInWelcomeProps,
    },
  },
};

describe('Mercado Libre Navigation', () => {
  describe('User Menu Component', () => {
    it('matches the default snapshot for user menu, in mobile and logged in user', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <UserMenu
          {...baseProps}
        />
      );

      expect(renderer.render(component)).toMatchSnapshot();
    });

    it('matches the default snapshot for user menu, in mobile and guest user', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <UserMenu
          {...baseProps}
          isUserLoggedIn={false}
          guestMenu={{
            mobile: {
              welcome: guestWelcomeProps,
              userLinksSections: userLinksSectionsProps,
            },
          }}
        />
      );

      expect(renderer.render(component)).toMatchSnapshot();
    });

    it('matches the default snapshot for user menu, in desktop and logged in user', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <UserMenu
          {...baseProps}
          isDesktop
        />
      );

      expect(renderer.render(component)).toMatchSnapshot();
    });

    it('matches the default snapshot for user menu, in desktop and guest user', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <UserMenu
          {...baseProps}
          isDesktop
          isUserLoggedIn={false}
          guestMenu={{
            mobile: {
              welcome: guestWelcomeProps,
              userLinksSections: userLinksSectionsProps,
            },
            desktop: {
              userLinks: userLinksSectionsProps,
            },
          }}
        />
      );

      expect(renderer.render(component)).toMatchSnapshot();
    });
  });
});
