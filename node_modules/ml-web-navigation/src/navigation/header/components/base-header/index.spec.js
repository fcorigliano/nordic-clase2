const React = require('react');
const ShallowRenderer = require('react-test-renderer/shallow');
const BaseHeader = require('.');

const baseProps = {
  type: 'plus',
  siteId: 'MLA',
  logo: { url: 'https://www.mercadolibre.com.ar', label: 'Mercado Libre' },
  navMenuSwitchId: 'nav-header-menu-switch',
  melilab: {
    isEnabled: false,
  },
  isMobile: true,
  isDesktop: false,
  userMenu: {
    isUserLoggedIn: true,
  },
  cart: {
    cartInfo: { badge_icon: { quantity: 0 }, location: { type: 'address', value: '1014518121' } },
    show: true,
    isMobile: true,
    url: 'https://www.mercadolibre.com.ar/gz/cart',
    title: 'Carrito',
    cdnDomain: 'https://http2.mlstatic.com',
  },
  notifications: {
    count: 0,
  },
  cp: {
    show: true,
    isDesktop: false,
    selector: '[data-js=cp]',
    application: 'frontend-navigations',
  },
  searchbox: {
    category: null,
    isMobile: false,
    isDesktop: false,
    closeTitle: 'Cerrar',
    clearTitle: 'Limpiar',
    placeholderMobile: '',
    placeholder: '',
    widget: null,
  },
  navMenu: {
    show: true,
    links: [],
  },
  skipToMainContent: {
    text: 'Ir a contenido principal',
  },
  downloadApp: {
    'footer-top': [{
      type: 'html',
      typeData: {
        content: '<div>footerTop</div>',
      },
    }],
    'header-top': [{
      type: 'html',
      typeData: {
        content: '<div>headerTop</div>',
      },
    }],
    'header-bottom': [{
      type: 'html',
      typeData: {
        content: '<div>headerBottom</div>',
      },
    }],
  },
};

describe('Mercado Libre Navigation', () => {
  describe('Base Header Component', () => {
    it('matches the default snapshot for Mobile and logged in user', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <BaseHeader
          {...baseProps}
        >
          <div />
        </BaseHeader>
      );
      expect(renderer.render(component)).toMatchSnapshot();
    });

    it('matches the default snapshot for Mobile and logged in user but no cart', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <BaseHeader
          {...baseProps}
          cart={{ show: false }}
        >
          <div />
        </BaseHeader>
      );
      expect(renderer.render(component)).toMatchSnapshot();
    });

    it('matches the default snapshot for Desktop and logged in user', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <BaseHeader
          {...baseProps}
          isMobile={false}
        >
          <div />
        </BaseHeader>
      );
      expect(renderer.render(component)).toMatchSnapshot();
    });

    it('matches the default snapshot for mobile and guest user', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <BaseHeader
          {...baseProps}
          isMobile
          userMenu={{
            isUserLoggedIn: false,
          }}
        >
          <div />
        </BaseHeader>
      );
      expect(renderer.render(component)).toMatchSnapshot();
    });

    it('matches the default snapshot for desktop and guest user', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <BaseHeader
          {...baseProps}
          isMobile={false}
          userMenu={{
            isUserLoggedIn: false,
          }}
        >
          <div />
        </BaseHeader>
      );
      expect(renderer.render(component)).toMatchSnapshot();
    });

    it('matches the default snapshot for Mobile and logged in user but no cp', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <BaseHeader
          {...baseProps}
          cp={{ show: false }}
          isMobile
          userMenu={{
            isUserLoggedIn: false,
          }}
        >
          <div />
        </BaseHeader>
      );
      expect(renderer.render(component)).toMatchSnapshot();
    });

    it('matches the default snapshot without user menu and notifications', () => {
      const renderer = new ShallowRenderer();
      const component = (
        <BaseHeader
          {...baseProps}
          isMobile
          userMenu={{
            isUserLoggedIn: false,
          }}
          showNotifications={false}
          showUserMenu={false}
        >
          <div />
        </BaseHeader>
      );
      expect(renderer.render(component)).toMatchSnapshot();
    });
  });
});
