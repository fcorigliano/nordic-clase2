const React = require('react');

const toBoolean = (value) => value === 'true'
  ? true
  : (value === 'false' ? false : value );

const toObject = (value) => JSON.parse(value);

const toString = (value) => value;

const mapper = {
  hideDownloadApp: toBoolean,
  turnOnLoansMessages: toBoolean,
  turnOnKycMessages: toBoolean,
  internal: toObject,
  currentLocation: toObject,
  category: toObject,
  default: toString,
};

module.exports = (req, res) => {
  const View = () => (
    <div>
      This is a demo page
    </div>
  );

  // transform true and false strings to booleans
  const navigationOptions = Object.keys(req.query || {})
    .reduce((options, key) => ({
      ...options,
      [key]: (mapper[key] || mapper.default)(req.query[key])
    }), {});

  res.render(View, {}, { navigationOptions });
};
