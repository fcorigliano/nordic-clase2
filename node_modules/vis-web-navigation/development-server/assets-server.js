/**
 * Babel register
 */
require('@babel/register')({
  ignore: ['node_modules'],
  presets: [
    '@babel/preset-react',
  ],
});

const ragnar = require('nordic/ragnar');
const express = require('express');

const { version } = require('../package.json');

const app = ragnar.router();

app.use((req, res, next) => {
  res.set('Access-Control-Allow-Origin', '*');
  next();
});

app.use('/frontend-assets/vis-web-navigation/ui-navigation/:version', express.static(`object-storage-assets/ui-navigation/${version}`));

ragnar({
  config: {
    basePath: '/',
    server: {
      port: 8081,
      securePort: 8443,
      host: '0.0.0.0',
    },
    version,
    middlewares: {
      platform: false,
      csrf: false,
    },
  },
  appRouter: app,
});
