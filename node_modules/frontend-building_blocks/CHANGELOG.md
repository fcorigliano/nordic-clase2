# Changelog

## Next release

## 4.2.0

- [#50](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/50) Add generation of http error pages client for Nordic Pages

## 4.1.4

- [#49](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/49) Fix: change `ts-loader` configuration only for the client bundle to use `ESM` instead of `CommonJS` in the Babel plugin which removes the Nordic Pages server code. It also removes the `transpileOnly` option as it disables type checking in favor of making compilation faster, but we consider type checking more important for TS projects.

## 4.1.3

- [#48](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/48) Fix the name of the Nordic Page configuration method (`setPageSettings`) in the Babel plugin which removes the server code. 

## 4.1.2

- [#47](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/47) Fix: do not add the hot middleware entry client in case of polyfills entry.

- [#46](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/46) Add optimization block and fix automatic entry generator for Nordic Pages.

## 4.1.1

- [#44](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/44) Update Typescript to ^4.7.2 and exclude test files from package

## 4.1.0

- [#24](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/24) Add Nordic Page feature

  - [#39](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/39) Remove use of experimental.nordicPages to enable the feature

  - [#38](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/38) Apply renamings of Nordic Page

  - [#36](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/36) Change runtimeJS string property for hydrate boolean property

  - [#34](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/34) Add clean client directory method

  - [#33](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/33) Add setPageConfiguration to plugin babel exports

  - [#27](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/27) Fix nordic page sourcemap entrypoints generator and change nordic page client path 
    - Use import/export in the client template.
    - Update tests due to new client name format to fix source map generation.  
    - Change the Nordic Pages client path.

  - [#26](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/26) Add nordic-pages polyfills entry

  - [#25](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/25) Change hydrateClient to runtimeJS and fix error at reading runtimeJS

  - [#23](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/23) Add a babel plugin (`babel-plugin-remove-exported-code-snippets`) to remove code snippets from **Nordic Pages** to keep the browser package free of server-side code. For example: `getServerSideProps()` method. The plugin was added to the `classic` and `spa` presets.

  - [#22](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/22) Add entry points and create clients for nordic pages

- Updated dependencies:
  - frontend-page@2.1.0

## 4.0.8

- [#41](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/41) 
  - Bump `webpack-dev-server` to fix vulnerabilities found in the library dependency tree.
  - Remove `imagemin-mozjpeg` and `imagemin-pngquant` as we have imageoptim as image optimization process and there is no fix for the vulns found in the dependency tree. 

## 4.0.7

- [#37](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/37) Fast refresh dependencies update.

## 4.0.6

- [#28](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/28) Update Typescript dep to 4.5.3. [Release notes](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-5.html)

## 4.0.5

- [#20](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/20) Update Typescript dep to 4.4.4. [Release notes](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-4.html)

## 4.0.4

- [#19](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/19) Fix generated bundle: stop using ES2015 syntax on webpack runtime code.

## 4.0.3

- [#18](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/18) Add `imagesPath`config option to `spa` preset and remove deprecated `swift` option from spa and preact presets.

## 4.0.2

- [#15](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/15) change relative path to github url on readme to avoid unresolved routes on nordic documetation and test-app removed

## 4.0.1

- [#14](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/14) Fix images hash: the Image hash was override by ImageMinimizerPlugin.

## 4.0.0

- [#12](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/12) Major release changes ðŸ‘‡

### **:warning: Breaking changes:**

- Only support `webpack 5`
- Swift configuration block is no longer available. If you need to use it, please install and configure a custom block: `customConfig()`
- Minimum supported `Node.js` version is `14`
- Using `.css` entries is no longer recommended. Webpack 4 used to generate a `.js` entry with the require to the `.css` file and now that file is empty.
- Using `'vendor'` as `entryPoint` is no longer recommended (please follow [these recommendations](#what-should-i-do-if-i-have-a-vendor-entry-point) if you have it). Webpack < 5 used to allow the use of an entry point as splitChunk and this is no longer allowed when the entry point is not a parent of the selected modules (e.g via dependesOn). Besides that, the "vendor" entry will conflict with the cache group "vendor" defined by default on the `spa` preset and the default webpack config for web apps defined on the Nordic recommended scaffolding (using `classic` preset).

### **Other changes:**

- Move the lazy block from `frontend-lazy` to `frontend-building-blocks`.
- `clean-webpack-plugin` was removed in order to use the `clean:true` option of the default webpack `output`. If the `setOutput` block receives a string, it will be set to `clean:true` by default, otherwise this option must be configured, please read the full options [here](https://webpack.js.org/configuration/output/#outputclean).
- `imagemin-webpack` was replaced by [ImageMinimizerPlugin](https://webpack.js.org/plugins/image-minimizer-webpack-plugin/)
- `terser-webpack-plugin` was removed since it comes along with webpack 5
- `postcss` added as dependency since it was moved to peerDependencies in `autoprefixer`
- `url-loader` and `file-loader` are depracated for webpack 5. Migrated to [asset modules](https://webpack.js.org/guides/asset-modules/).
- Make use of `^` for internal all company dependencies.

### **Major external dependencies updates:**

  - autoprefixer: [10.3.0](https://github.com/postcss/autoprefixer/compare/9.6.4...10.3.0)
  - cssnano: [5.0.6](https://github.com/cssnano/cssnano/compare/v4.1.10...cssnano@5.0.6)
  - copy-webpack-plugin: [9.0.1](https://github.com/webpack-contrib/copy-webpack-plugin/compare/v5.0.4...v9.0.1)
  - imagemin-mozjpeg: [9.0.0](https://github.com/imagemin/imagemin-mozjpeg/compare/v8.0.0...v9.0.0)	
  - imagemin-pngquant: [9.0.2](https://github.com/imagemin/imagemin-pngquant/compare/v8.0.0...v9.0.2)
  - imagemin-svgo: [9.0.0](https://github.com/imagemin/imagemin-svgo/compare/v7.0.0...v9.0.0)
  - mini-css-extract-plugin: [2.1.0](https://github.com/webpack-contrib/mini-css-extract-plugin/compare/v1.3.9...v2.1.0)
  - postcss-loader: [6.1.1](https://github.com/webpack-contrib/postcss-loader/compare/v4.2.0...v6.1.1)
  - ts-loader: [9.2.3](https://github.com/TypeStrong/ts-loader/compare/v7.0.5...v9.2.3)
  - typescript: [4.3.4](https://github.com/microsoft/TypeScript/compare/v3.9.5...v4.3.5)
  - webpack: [5.45.1](https://github.com/webpack/webpack/compare/v4.46.0...v5.45.1)
  - webpack-bundle-analyzer: [4.4.2](https://github.com/webpack-contrib/webpack-bundle-analyzer/blob/master/CHANGELOG.md#442)
  - webpack-cli: [4.7.2](https://github.com/webpack/webpack-cli/compare/v3.3.9...webpack-cli@4.7.2)
  - webpack-node-externals: [3.0.0](https://github.com/liady/webpack-node-externals/compare/v1.7.2...v3.0.0)
  - webpack-manifest-plugin: [2.2.0](https://github.com/shellscape/webpack-manifest-plugin/compare/v2.2.0...v3.1.1)
    - Known Issues: when using a non-js entrypoint (e.g. `entry.txt`) Webpack v5 will assign a chunk named as `main.txt` as well as an asset in `stats` named `entry.txt`, with both appearing in the resulting manifest. This appears to be a bug in Webpack v5 with no current workaround.
  - sass-loader: [12.1.0](https://github.com/webpack-contrib/sass-loader/compare/v10.1.1...v12.1.0)
    - Please note that using ~ is deprecated and can be removed from your code (the plugin recommend it), but they still support it for historical reasons, please read the full changelog [here](https://github.com/webpack-contrib/sass-loader/blob/master/CHANGELOG.md#1100-2021-02-05).


#### What should I do if I have a `vendor` entry point?

**classic preset**:

It depends on your case, but keep in mind that using 'vendor' entry point as splitChunk strategy won't work and webpack might warn you about it.
  Some ways to manage it:
  
  - Delete the `vendor` entry and use the default `webpack.config.js` defined on the `web-nordic` base scaffolding.
  
  - Rename it if that make sense to your project but take in mind that most cases require to remove it and add that modules to cache group's or add them to existing entry points if you need them to be evaluated on startup (e.g. via [dependsOn](https://webpack.js.org/concepts/entry-points/#entrydescription-object))

**spa preset**:

  - Delete that entry and use the default webpack config:
  ```javascript
    const wpConfig = createConfig([
      ...
      entryPoint({
        app: './app/client/app.js',
      }),
      spaPreset({
        buildPath: './build',
        publicPath: `https://http2.mlstatic.com/resources/frontend/statics/${name}/`,
        swift: {
          friendlyUrl: name,
        },
      }),
      ...
    ]);
  ```

## 3.12.0

- [#6](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/6) Fast refresh feature
- [#9](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/9) Add webpack-conformance-plugin

## 3.11.0

- [#7](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/7) Replace node-sass by dart-sass

## 3.10.2

- [#4](https://github.com/mercadolibre/fury_frontend-building-blocks/pull/4) Fix: Fixed broken classic preset

## 3.10.1

- [#2](https://github.com/mercadolibre/fury_frontend-building_blocks/pull/2) Fix: Use of caret for babel dependencies

## 3.10.0

- [#79](https://github.com/mercadolibre/frontend-building_blocks/pull/79) Feature: Added --analyze command to libs presets

## 3.9.0

- [#77](https://github.com/mercadolibre/frontend-building_blocks/pull/77) Add support for lazy granular strategy
- [#70](https://github.com/mercadolibre/frontend-building_blocks/pull/70) Feature: New building_block `lazy` - frontend-lazy integration

## 3.8.0

- [#72](https://github.com/mercadolibre/frontend-building_blocks/pull/72) Update typescript and ts-loader. Deprecate Node v8

## 3.7.0

- [#71](https://github.com/mercadolibre/frontend-building_blocks/pull/71) Feature: TS Loader support to settings options

## 3.6.0

- [#65](https://github.com/mercadolibre/frontend-building_blocks/pull/65) Remove additional assets generation with brotli compression
- [#66](https://github.com/mercadolibre/frontend-building_blocks/pull/66) Update typescript and ts-loader

## 3.5.0

- [#63](https://github.com/mercadolibre/frontend-building_blocks/pull/63) Feature: Babel support to Typescript

## 3.4.0

- [#61](https://github.com/mercadolibre/frontend-building_blocks/pull/61) Update building-blocks dependencies

  **Significative updates**
  - css-loader: `2.1.1 âžž 3.2.0` [Changelog](https://github.com/webpack-contrib/css-loader/blob/master/CHANGELOG.md#breaking-changes)
  - file-loader: `3.0.1 âžž 4.2.0` [Changelog](https://github.com/webpack-contrib/file-loader/blob/master/CHANGELOG.md)
  - imagemin-pngquant: `7.0.0 âžž 8.0.0` [Releases](https://github.com/imagemin/imagemin-pngquant/releases)
  - imagemin-webpack: `4.1.0 âžž 5.1.0` [Changelog](https://github.com/itgalaxy/imagemin-webpack/blob/master/CHANGELOG.md)
  - sass-loader: `7.1.0 âžž 8.0.0` [Changelog](https://github.com/webpack-contrib/sass-loader/blob/master/CHANGELOG.md)
  - terser-webpack-plugin: `1.3.0 âžž 2.1.2` [Changelog](https://github.com/webpack-contrib/terser-webpack-plugin/blob/master/CHANGELOG.md#200-2019-09-05)
  - url-loader: `1.1.2 âžž 2.2.0` [Changelog](https://github.com/webpack-contrib/url-loader/blob/master/CHANGELOG.md)

## For previous releases please check [Github releases section](https://github.com/mercadolibre/frontend-building_blocks/releases)
