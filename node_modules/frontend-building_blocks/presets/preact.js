/**
 * Module dependencies
 */
const { group, resolveAliases } = require('../index');
const classicPreset = require('./classic');
const { fastRefreshBabelPlugin } = require('../utils/fast-refresh');

/**
 * Preact Preset
 */
function preactPreset({
  buildPath, publicPath, babelrc, target,
} = {}) {
  const babelConfig = {
    ...babelrc,
    plugins: [
      ...babelrc && babelrc.plugins ? [...babelrc.plugins] : [],
      ...fastRefreshBabelPlugin('preact'),
    ],
  };

  return group([
    resolveAliases({
      react: 'preact-compat',
      'react-dom': 'preact-compat',
    }),
    classicPreset({
      buildPath,
      publicPath,
      babelrc: babelConfig,
      target,
    }),
  ]);
}

/**
 * Expose preactPreset
 */
module.exports = preactPreset;
