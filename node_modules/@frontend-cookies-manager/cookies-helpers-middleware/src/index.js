const { get } = require('./cookies-preferences');
const { getUserConsentCookieCategory } = require('./user-consent-cookie-category');
const { request } = require('./constants/namespaces');

const middleware = (req, res, next) => {
  const promise = get(req, res);

  const getCookiesUserPreferences = () => promise;

  const userConsentCookieCategory = getUserConsentCookieCategory(req, promise);

  req[request] = {
    userConsentCookieCategory,
    getCookiesUserPreferences,
  };

  next();
};

module.exports = {
  middleware,
};
