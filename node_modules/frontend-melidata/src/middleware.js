const MelidataTrackService = require('./services/melidata-track');
const melidataTrackService = new MelidataTrackService();

/**
 * Melidata Middleware
 */
function melidataMiddleware(req, res, next) {
  let { melidataTrack } = req;
  if (!melidataTrack) {
    melidataTrack = melidataTrackService.createNewTrack();
  }
  req.melidataTrack = melidataTrackService.fillTrack(req, melidataTrack);

  return next();
}

module.exports = melidataMiddleware;
