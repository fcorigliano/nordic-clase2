# Country configuration

> A set of country-specific data for formatting and parsing.

The module contain a simple interface to get the country's configuration
 data for a single country, a middleware that exposes the data to a
 request object and a complete list of supported countries.


## Installation

```
npm install frontend-country_config
```


## country configuration getter

Provides the data for a single country.

### Available data

The data is the same as in [Countries API](https://api.mercadolibre.com/countries/)
with the addition of the [currencies](https://api.mercadolibre.com/currencies/)
supported by each [site](https://api.mercadolibre.com/sites/MLA/?attributes=currencies).
The goal is to provide a fresh country configuration data that stays up-to-date with
the official APIs but with no additional requests, think on it as in
some kind of caching layer.

Complete list:

- `id`: an id of a country in a [ISO_3166-1_alpha-2](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2)
 format. Example: `'AR'`
- `name`: the name of a country in spanish as it is using in Meli.
 Example: `'Argentina'`
- `locale`: identify a specific language and geographic region, its format
 is a combination of language code in ISO ISO 639-1 format and country
 code in ISO 3166 format separated by underscore. Example: `'es_AR'`
- `currency_id`: currency id in a ISO 4217 format. Example: `'ARS'`
- `currencies`: list of supported currencies and its characteristics. Example: `"currencies": "ARS": { "id": "ARS", "symbol": "$", "description": "Peso argentino", "decimal_places": 2 }`
- `decimal_separator`: the symbol is used as thousands delimiter in a
 number. **Warning**: not always is the same as it defined in
 [CLDR](http://cldr.unicode.org/). Example: `','`
- `thousands_separator`: the symbol is used as thousands delimiter in a
 number. **Warning**: not always is the same as it defined in
 [CLDR](http://cldr.unicode.org/). Example: `'.'`
- time_zone: time zone offset. Example: `'GMT-03:00'`
- `geo_information`: currently contain only a location of a geographical
 center of a country. Example: `"location": { "latitude": -38.416097, "longitude": -63.616672 }`
- `states`: the list of a country states

### Usage

```js
const countryConfig = require('frontend-country_config');
const countryData = countryConfig('AR');
const locale = require('express-locale');

// Print the available data
console.log(countryData);
/*
{
  id: 'AR',
  name: 'Argentina',
  locale: 'es_AR',
  currency_id: 'ARS',
  "currencies": {
    "USD": {
      "id": "USD",
      "symbol": "U$S",
      "description": "Dólar",
      "decimal_places": 2
    },
    "ARS": {
      "id": "ARS",
      "symbol": "$",
      "description": "Peso argentino",
      "decimal_places": 2
    }
  },
  decimal_separator: ',',
  thousands_separator: '.',
  time_zone: 'GMT-03:00',
  geo_information: {
    location: {
      latitude: -38.416097,
      longitude: -63.616672
    }
  },
  states: [...]
}
*/

// Configure the app locale by using the express-locale middleware.
// Do not try this at home!
app.use(locale({
  {
    default: countryData.locale,
    priority: ['default']
  }
}));
```


## countryConfig.middleware
A middleware function exposes the country data for the current request
 as `req.country`. It has a dependency on [frontend-platform_detection](https://github.com/mercadolibre/frontend-platform_detection)
 middleware that should be used before the `countryConfig.middleware`.

The list of available data is the same as in country getter.

### Usage

```js
const express = require('express');
const { middleware } = require('frontend-country_config');
const app = express();

app.use(middleware);

app.use('/', (req, res, next) => {
  console.log(req.country.name); // Argentina
  console.log(req.country.locale); // es_AR
  next();
});
```


## countryConfig.countries

A complete list of configurations data for the countries available inside
 the Mercado Libre.

### Usage

```js
const { countries } = require('frontend-country_config');

// Print the keys of all countries in a list
console.log(Object.keys(countries))
// [ 'AR', 'BR', 'CO', 'CR', 'CL', 'EC', 'MX', 'PA', 'PE', 'PT', 'DO', 'UY', 'VE', 'GT', 'BO', 'HN', 'NI', 'SV', 'PR', 'PY', 'CU' ]
```


## Auto-updates

The updates checker feature depends on the `NODE_COUNTRY_UPDATES` variable. It needs to be set up.


## License

Copyright © 2016.
