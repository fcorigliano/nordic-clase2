const analytics = require('.');
const fetchTraceabilityConsent = require('./traceability-consent');

module.exports = async function bundle(req, MeliGA, nonceCSP) {
  const analyticsProps = MeliGA.rewind();
  const traceabilityUserConsent = await fetchTraceabilityConsent(req);

  return analytics.track(req, analyticsProps, nonceCSP, traceabilityUserConsent);
};
