const guestUserMenuProps = require('./props');

const baseProps = {
  type: 'full',
  platform: {
    siteId: 'MLA',
    id: 'MP',
    domain: 'mercadopago.com.ar',
  },
  actualLocation: 'https://www.mercadopago.com.ar/',
  browser: {
    support: {
      webp: true,
      prefetch: true,
      preconnect: true,
      pushNotifications: false,
      serviceWorkers: false,
      brotli: true,
    },
    name: 'chrome',
    version: '75.0.3770',
    major: '75',
    minor: '0',
    patch: '3770',
    userAgent: 'Chrome 75.0.3770 / Mac OS X 10.13.6',
  },
  cdn: {
    name: 'default',
    link: 'https://http2.mlstatic.com',
    cssFileSuffix: '',
  },
  urls: {
    mainDomain: { name: '', link: 'mercadopago.com.ar' },
    baseDomain: { name: '', link: 'https://www.mercadopago.com.ar' },
    rootDomain: { name: '', link: 'https://www.mercadopago.com' },
    listing: { name: 'Listado' },
    buyingFlow: { name: '' },
    downloadAppLanding: {
      name: '¡Descarga gratis la app de Mercado&nbsp;Libre!',
    },
    downloadAppStore: { name: '¡Compra y vende con la app!' },
    institucional: {
      link: 'https://ideas.mercadolibre.com/ar/noticias/',
      name: 'Mercado Libre',
    },
    jobs: {
      link: 'http://www.mercadolibre.com/empleos',
      name: 'Trabaja con nosotros',
    },
    investor: {
      link: 'http://investor.mercadolibre.com',
      name: 'Investor relations',
    },
    developers: {
      link: 'https://developers.mercadopago.com',
      name: 'Desarrolladores',
    },
    login: {
      name: 'Ingresá',
      link:
        'https://www.mercadolibre.com/jms/mla/lgz/login?platform_id=MP&go=https%3A%2F%2Fdev.mercadopago.com.ar%3A8443%2F&loginType=explicit',
    },
    logout: {
      name: 'Salir',
      link:
        'https://www.mercadolibre.com/jms/mla/lgz/logout?go=https://www.mercadopago.com.ar?go=https%3A%2F%2Fdev.mercadopago.com.ar%3A8443%2F',
    },
    registration: {
      name: 'Creá tu cuenta',
      link:
        'https://registration.mercadopago.com.ar/registration-mp?confirmation_url=https%3A%2F%2Fdev.mercadopago.com.ar%3A8443%2F',
    },
    notifications: {
      name: 'Notificaciones',
      link: 'https://www.mercadopago.com.ar/notifications',
    },
    notificationsCenter: {
      name: 'Notificaciones',
      link: 'https://www.mercadopago.com.ar/notifications',
    },
    mpago: { name: 'Mercado Pago' },
    mclics: {
      name: 'Mercado Libre Publicidad',
      link: 'https://publicidad.mercadolibre.com.ar',
    },
    mshops: { name: 'Mercado Shops', link: 'https://www.mercadoshops.com.ar' },
    menvios: {
      name: 'Mercado Envíos',
      link: 'https://envios.mercadolibre.com.ar/',
    },
    mideas: { name: 'Mercado Libre Ideas' },
    trends: { name: 'Tendencias' },
    officialStores: { name: 'Tiendas oficiales' },
    loyalty: { name: 'Mercado Puntos' },
    credits: { name: 'Mercado Crédito' },
    home: { name: 'Inicio' },
    sitemap: { name: 'Mapa del sitio' },
    myAccount: {
      name: 'Ver Perfil',
      link: 'https://www.mercadopago.com.ar/settings/account',
    },
    yourPurchases: { name: 'Tus compras' },
    purchases: { name: 'Compras' },
    yourNavigation: { name: 'Tu historial' },
    navigation: { name: 'Historial' },
    offers: { name: 'Ofertas de la semana' },
    bookmarks: { name: 'Favoritos' },
    categories: { name: 'Categorías' },
    mobileCategories: { name: 'Categorías' },
    mobileCPlocations: { name: 'Ingresa tu domicilio' },
    cpLocation: { name: 'Ingresa tu domicilio' },
    profile: { name: 'Perfil' },
    politics: { name: 'Políticas de privacidad' },
    tyc: {
      name: 'Términos y políticas',
      link: 'https://www.mercadopago.com.ar/ayuda/terminos-y-politicas_194',
    },
    sell: { name: 'Vender' },
    syi: { name: 'Vender' },
    cart: { name: 'Carrito' },
    accountMoney: { name: 'Dinero en Mercado Pago' },
    discounts: { name: 'Descuentos exclusivos' },
    helpMain: { name: 'Ayuda', link: 'https://www.mercadopago.com.ar/ayuda' },
    helpBuy: { name: 'Comprar' },
    helpSell: { name: 'Vender' },
    helpFreeSell: { name: 'Vende gratis' },
    helpContact: {
      name: 'Resolución de problemas',
      link: 'https://www.mercadopago.com.ar/ayuda',
    },
    helpShipping: { name: 'Cómo recibir el producto' },
    helpSecurity: { name: 'Centro de seguridad' },
    helpMpagoFaq: { name: 'Comprar con MercadoPago' },
    helpBpp: { name: 'Compra Protegida' },
    helpClaims: { name: 'Libro de reclamaciones' },
    twitter: { name: 'Twitter', link: 'https://twitter.com/mercadopago' },
    facebook: {
      name: 'Facebook',
      link: 'https://www.facebook.com/MercadoPago',
    },
    instagram: { name: 'Instagram' },
    youtube: {
      name: 'YouTube',
      link: 'https://www.youtube.com/channel/UC4fvWBwnNs0d97Kwp_6Y64g',
    },
    supermercado: { name: 'Supermercado' },
    mlibre: { name: 'Mercado Libre', link: 'https://www.mercadolibre.com.ar' },
    about: {
      name: 'Sobre Mercado Pago',
      link: 'https://www.mercadopago.com.ar/aboutmp',
    },
    countries: {
      link: 'https://www.mercadopago.com',
      name: 'Ver otros países',
    },
    summary: {
      name: 'Mi cuenta',
      link: 'https://www.mercadopago.com.ar/summary',
    },
    operations: {
      name: 'Operaciones',
      link: 'https://www.mercadopago.com.ar/transactions',
    },
    paymentSolutions: {
      name: 'Soluciones de Pago',
      link: 'https://www.mercadopago.com.ar/receive-payments',
    },
    configuration: {
      name: 'Configuración',
      link: 'https://www.mercadopago.com.ar/settings',
    },
    sellerAccountPromo: {
      name: 'Prueba 30 días la cuenta vendedor',
      link: 'https://www.mercadopago.com.ar/summary/seller-account-promo',
    },
    linkedin: {
      name: 'Linkedin',
      link: 'https://www.linkedin.com/showcase/10664354',
    },
    reauthentication: {
      link: 'https://www.mercadolibre.com/jms/mla/lgz/authentication',
    },
    helpMoneyReleased: { link: 'https://www.mercadopago.com.ar/ayuda/_275' },
    helpReceivePayment: {
      link: 'https://www.mercadopago.com.ar/ayuda/empezar-cobrar_219',
    },
    landingPayer: {
      link: 'https://www.mercadopago.com.ar/pagar-compras-online',
    },
    landingSeller: {
      link: 'https://www.mercadopago.com.ar/recibir-pagos-online',
    },
    commercial: {
      name: 'Contacto comercial',
      link: 'https://www.mercadopago.com.ar/comercial',
    },
  },
  device: { type: 'desktop', mobile: false, desktop: true, lowEnd: false },
  labels: {
    headTitle: 'Mercado Pago',
    companyName: 'Mercado Pago',
    extraCompanyName: 'Arias 3751 piso 7mo, 1430 Ciudad Autónoma de Buenos Aires, Argentina',
  },
  configSchema: {
    i18n: {},
    header: {
      menu: [
        { key: 'summary', target: '_blank' },
        { key: 'break', isBreak: true },
        { key: 'helpMain', target: '_blank' },
        { key: 'logout', target: '_self' },
      ],
      items: [
        {
          className: 'option-register',
          key: 'registration',
          name: 'Registrate',
          target: '_self',
        },
        { className: 'option-help-tablet', key: 'helpMain', target: '_blank' },
        { className: 'option-login', key: 'login', target: '_self' },
        {
          className: 'option-register-tablet',
          key: 'registration',
          target: '_self',
        },
        {
          className: 'option-help',
          key: 'helpMain',
          icon: 'nav-icon-help',
          target: '_blank',
        },
      ],
    },
    footerAccess: { hidden: true },
    footer: {
      navigation: ['helpMain', 'commercial', 'tyc', 'developers', 'investor'],
      social: ['facebook', 'twitter', 'linkedin', 'youtube'],
    },
    styles: { useProximaNova: true },
    headerMenu: [
      { link: 'categories' },
      { link: 'navigation' },
      { link: 'officialStores' },
      { link: 'offers' },
      { link: 'sell' },
      { link: 'helpMain' },
    ],
    mobileHeaderMenu: {
      logged: [
        [
          'home',
          'notificationsCenter',
          'myAccount',
          'purchases',
          'bookmarks',
          'discounts',
          'navigation',
          'sell',
        ],
        ['mobileCategories', 'offers', 'officialStores'],
        ['helpMain'],
        ['downloadAppStore'],
      ],
      guest: [
        ['home', 'discounts', 'navigation', 'sell'],
        ['mobileCategories', 'offers', 'officialStores'],
        ['helpMain'],
        ['downloadAppStore'],
      ],
    },
    a2hsAvailablePaths: ['^$', '^/$', '^/gz/notifications/*', '^/pwa$'],
    cleanServiceWorkers: false,
    mobileSplashOnOff: {
      homes_palpatine: true,
      vpp_frontend: true,
      default: false,
    },
    userMenuGuest: {
      title: 'Bienvenido',
      subtitle: 'Ingresa a tu cuenta para ver tus compras, favoritos, etc.',
    },
  },
  user: {
    raw: {
      thumbnail: {
        picture_id: '680949-MLA32450503590_102019',
        picture_url:
          'https://mla-s1-p.mlstatic.com/680949-MLA32450503590_102019-O.jpg',
      },
    },
  },
  navigationPIIData: {},
};

baseProps.navigationUrls = baseProps.urls;

const mockedConfig = {
  userInfo: {
    greeting: 'Hola',
    brandTitle: 'Mi Mercado Pago',
    redirect: 'summary',
  },
  menuLinks: {
    logged: [
      { key: 'break', isBreak: true },
      { key: 'logout', target: '_self', class: 'nav-header-user-logout-link' },
    ],
    guest: [
      { key: 'break', isBreak: true },
      { key: 'helpMain', target: '_self', class: 'nav-header-guest-logout-link', className: 'nav-header-guest-logout-link' },
    ],
  },
  itemsLinks: {
    logged: [
      { key: 'helpMain', target: '_blank' },
    ],
    guest: [
      { key: 'login', target: '_self' },
      { key: 'registration', target: '_self' },
      { key: 'helpMain', target: '_blank' },
    ],
  },
  mobileItemsLinks: {
    logged: [
      { key: 'helpMain', target: '_blank' },
    ],
    guest: [
      { key: 'login', target: '_self' },
      { key: 'registrationMobile', target: '_self' },
      { key: 'helpMain', target: '_blank' },
    ],
  },
};

jest.mock('mp-navigation-config', () => ({ getValue: () => mockedConfig }));
jest.mock('../../../../../../src/navigation/header/components/user-menu/navigation/landing-navigation/props', () => () => ({
  'some-landing-prop': 'some-landing-value',
}));

describe('Mercado Pago Navigation', () => {
  describe('Guest User Menu props', () => {
    it('returns props needed for the Guest User Menu Component', () => {
      const props = guestUserMenuProps(baseProps);

      expect(props.links).toBeDefined();
      expect(Array.isArray(props.links)).toEqual(true);
      expect(props.siteId).toBeDefined();
    });

    it('returns empty props if type is hidden', () => {
      const props = guestUserMenuProps({ ...baseProps, type: 'hidden' });

      expect(props).toEqual({});
    });
  });
});
