const dataDogLogger = require('./data-dog');
const log = require('./log');
const loggerFactory = require('frontend-logger');
const { getPathName } = require('./utils');
const {
  NO_MODULE_NAME,
} = require('./constants.js');

/**
 * Creates a logger
 * @param {string} moduleName Module name used to define stat path. Eg.: frontend-navigations-mercado-libre
 * @returns {object} Logger
 */
const create = (moduleName = NO_MODULE_NAME) => {
  const loggerError = loggerFactory(moduleName);

  /**
   * Logs an error
   * @param {object} options Log options
   * @param {object} options.req Express request
   * @param {Error} options.error Error to log
   * @param {string} options.errorType Error type used to define stat path. Eg.: 'headerless_rendering'
   * @param {object} [options.tags={}] Optional tags
   * @param {string} options.message Message to log on app fury log.
   * If it's not provided it will not log on app fury log.
   * @returns {undefined}
   */
  const error = (options = {}) => {
    dataDogLogger.send({ ...options, name: getPathName(moduleName) });
  };

  return {
    error,
  };
};

module.exports = {
  create,
};
