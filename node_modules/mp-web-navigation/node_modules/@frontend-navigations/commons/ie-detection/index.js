const IE_BROWSER_NAME = 'ie';

/**
 * From the browser retrieved from the express request object, this method returns
 * another object with the necessary information to distinguish between IE browsers and versions.
 * If `broser.name` and `browser.major` are null or undefined, this method returns `{}`
 * @param {object} browser - browser object retrieved from the request
 * @param {string} browser.name - browser name
 * @param {string} browser.major - browser major version
 * @returns {object} returns an object with the following information:
 * `isLessThanIe9`: true if it is IE and the version is less than 9
 * `isGreaterOrEqualThanIe9`: true if it is IE and the version is greater or equal than 9
 * `isIe`: true if it is IE
 */
const ieDetection = (browser) => {
  if (browser && browser.name && browser.major) {
    const browserVersion = parseInt(browser.major, 10);

    const isIe = browser.name === IE_BROWSER_NAME;
    const isLessThanIe9 = browserVersion < 9;

    return {
      isLessThanIe9: isIe && !isNaN(browserVersion) && isLessThanIe9,
      isGreaterOrEqualThanIe9: isIe && !isNaN(browserVersion) && !isLessThanIe9,
      isIe,
    };
  }

  return {};
};

module.exports = ieDetection;
