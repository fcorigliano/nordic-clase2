# fury-session
Session manager for Fury Sessions service. Express middleware implementation for Node js projects in Fury, based on express-session and key value store storage.

## How it works...

If you sign up for the Sessions service on your Fury front end, fury-session starts saving your sessions in a specially kvs created for that purpose. When you disable the Sessions service, fury-session stores your sessions using the traditional express-session module.

Configurable parameters:
- `name`: an alternative name of the session cookie, default is `"NSESSIONID"`
- `cookie`: override the default cookie config, for available options see https://github.com/expressjs/session#cookie
- `secret`: the secret used to sign the session ID cookie, default is `"furysessions"`
- `ttl`: lifetime of the data in session store specified in seconds
- `max_retries`: max retries to try to get the data from session store
- `retry_delay`: delay between the retries

## Install
npm install --save fury-session

## Current Version
fury-session@1.2.0

## A brief example...
```javascript
require('newrelic');

var express = require('express');
var bodyParser = require('body-parser'); // for reading POSTed form data into `req.body`
var cookieParser = require('cookie-parser'); // Session data is not saved in the cookie itself, just the session ID.
var session = require('fury-session'); // Session data is stored server-side.
var app = express();

app.use(cookieParser());
app.use(bodyParser());

 app.get('/ping', function (req, res) {
    res.send('pong')
 });

app.use(session({
    name: 'project_session',
    cookie: {
        maxAge: 1800000 // 30 minutes
    },
    ttl: 1800, // 30 minutes
    max_retries: 2,
    retry_delay: 40,
    secret: 'mycustomsecret'
}));

app.get('/', function(req, res){
    var html = '<form action="/" method="post">' +
        'Your name: <input type="text" name="userName"><br>' +
        '<button type="submit">Submit</button>' +
        '</form>' +
        '<form action="/delete" method="post">' +
        '<button type="submit">cerrar sesion</button>' +
        '</form>';
    if (req.session.userName) {
        html += '<br>Your id from your session is: ' + req.session.userName;
        console.log('id: ' + req.session.id + ' - username: ' + req.session.userName);
    }
    res.send(html);
});

app.post('/', function(req, res){
    req.session.userName = req.body.userName;
    res.redirect('/');
});

app.post('/delete', function(req, res){
    req.session.destroy();
    res.redirect('/');
});

var server = app.listen(8080, function () {
    var port = server.address().port;
    console.log('Example app listening at http://localhost:%s', port);
});
```

#### For more information...
arquitectura@mercadolibre.com
